<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="8/23/2016 2:19:29 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="W7PC01XQ1T"
  DTS:CreatorName="ANGLICARE-SA\jshen"
  DTS:DTSID="{CCD1442F-A88C-42D6-81EF-D0DBFB5EB43A}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="13.0.2164.0"
  DTS:LocaleID="3081"
  DTS:ObjectName="Conform_RiskMan_Fact - DEV"
  DTS:PackageType="5"
  DTS:ProtectionLevel="0"
  DTS:VersionBuild="616"
  DTS:VersionGUID="{FD0093A6-A0E2-4315-9D3E-7C53D439C249}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[devsql-1\whouse.DWHB.asadwh]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
      DTS:ObjectName="devsql-1\whouse.DWHB.asadwh">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=devsql-1\whouse;Initial Catalog=DWHB;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D9171BDE-8638-46C2-BCA8-282F32F48C91}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="anniversary_date_key">
      <DTS:VariableValue
        DTS:DataType="3">9999999</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{35B5F04A-AB46-4E7D-A819-2F1AE215CD0D}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="change_reason_code_new">
      <DTS:VariableValue
        DTS:DataType="8">N</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{550E917C-FE27-4347-A566-044E71484F06}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="change_reason_code_update">
      <DTS:VariableValue
        DTS:DataType="8">U</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D9DBE83D-5210-425D-99A5-7453E4FD1CA9}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="change_reason_description_new">
      <DTS:VariableValue
        DTS:DataType="8">NEW</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{01B2D5C1-D4DA-4E24-81F4-DA98AC8A4164}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="change_reason_description_update">
      <DTS:VariableValue
        DTS:DataType="8">UPDATE</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{33B72EDF-737C-4D6C-BCD4-5CB11C9CA6B2}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="current_row_indicator">
      <DTS:VariableValue
        DTS:DataType="8">Y</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{17D8DAEF-0702-47F4-AC94-BA9DDB305203}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="GETDATE()"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="etl_start_date">
      <DTS:VariableValue
        DTS:DataType="7">8/3/2017 1:46:46 PM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{9ED3CCF1-5B9E-4C31-B85D-D2DB32AD7A36}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="manager_pos_key">
      <DTS:VariableValue
        DTS:DataType="3">1694</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{B0CF5A8B-105B-46D1-879D-E69BCEDB6C9A}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="manger_key">
      <DTS:VariableValue
        DTS:DataType="3">1780</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{5E9F3E47-F4B7-4F5B-B88C-F23A108DD8F0}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="new_position_flag">
      <DTS:VariableValue
        DTS:DataType="8">Y</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{EF2265BB-7D06-4B9D-817A-3C4608148049}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="position_vacant_date_key">
      <DTS:VariableValue
        DTS:DataType="3">9999999</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{424BCF32-1A58-472A-8F9E-2B1986E767D2}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="GETDATE()"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="row_effective_date">
      <DTS:VariableValue
        DTS:DataType="7">8/3/2017 1:46:46 PM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{9D4A82AD-AA31-4ACB-8B77-27A1D9DEB1CF}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="GETDATE()"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="row_expiration_date">
      <DTS:VariableValue
        DTS:DataType="7">8/3/2017 1:46:46 PM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{AB33D928-E3AC-4F60-BF4E-8ED4780A6F47}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="survery_completed">
      <DTS:VariableValue
        DTS:DataType="8">NO</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Sequence Container - Fact Tables"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Sequence Container"
      DTS:DTSID="{3F07DA7A-A22E-4021-9A6A-E8210D4DBFBC}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Sequence Container - Fact Tables">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Sequence Container"
          DTS:DTSID="{7443e704-d299-4914-80fc-28040bdb112e}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="INCIDENT_ACTION_FACT">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\Delete Existing Data"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{89984a77-029e-432d-9d56-b2cbc1f8d461}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Delete Existing Data"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="truncate table conform_riskman.INCIDENT_ACTION_FACT" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\EST - Write Job Finish info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{4b2aa37e-c01b-4543-8796-cc03c6520425}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Finish info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,2&#xA;,GETDATE() ,&#xA;4,&#xA;'Finish updating FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_riskman.incident_action_bridge'&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\EST - Write Job Start info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{901e16e5-101f-415d-8f37-436968e7480c}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Start info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,1&#xA;,GETDATE() ,&#xA;4,&#xA;'Start to update FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_riskman.INCIDENT_ACTION_FACT'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\Populate new data"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{f3d53293-0709-4649-b824-d6475f690971}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Populate new data"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="&#xA;IF OBJECT_ID('tempdb..#action_temp') IS NOT NULL drop table #action_temp;&#xA;&#xA;create table #action_temp&#xA;(batchid int,&#xA; pca varchar(255),&#xA; spca varchar(500),&#xA; due_date date,&#xA; com_date date&#xA; )&#xA;&#xA; create clustered index idx_riskman_temp_batchid on #action_temp(batchid);&#x9;&#x9; &#xA;&#xA; IF OBJECT_ID('tempdb..#action_temp_pca') IS NOT NULL drop table  #action_temp_pca&#xA;create table  #action_temp_pca&#xA;(batchid int,&#xA; action varchar(255)&#xA; )&#xA; &#xA; create clustered index idx_riskman_temp_pca_batchid on #action_temp_pca(batchid);&#x9;&#x9; &#xA;&#xA; IF OBJECT_ID('tempdb..#action_spca') IS NOT NULL drop table #action_temp_spca &#xA; create table  #action_temp_spca &#xA;(batchid int,&#xA; action varchar(500)&#xA; )&#xA;  create clustered index idx_riskman_temp_spca_batchid on #action_temp_spca(batchid);&#x9;&#x9;&#xA;&#xA;IF OBJECT_ID('tempdb..#action_ddate') IS NOT NULL  drop table #action_temp_ddate&#xA; create table #action_temp_ddate &#xA;(batchid int,&#xA; vdate datetime&#xA; )&#xA;   create clustered index idx_riskman_temp_ddadte_batchid on #action_temp_ddate(batchid);&#x9;&#x9;&#xA;&#xA;&#xA; IF OBJECT_ID('tempdb..#action_cdate') IS NOT NULL   drop table  #action_temp_cdate &#xA;  create table #action_temp_cdate &#xA;(batchid int,&#xA; vdate datetime&#xA; )&#xA;&#xA; create clustered index idx_riskman_temp_cdadte_batchid on #action_temp_cdate(batchid);&#x9;&#x9;&#xA; &#xA; --populate preventative_corrective_action&#xA; insert into #action_temp_pca&#xA; select distinct BatchID, left(ValueString,255)&#xA; from extract_riskman.FRM_DATA &#xA; where fieldname ='PCAPrevCorAct'&#xA;&#xA; --populate specific_preventative_corrective_action&#xA; insert into #action_temp_spca&#xA; select distinct BatchID, left(ValueString,500)&#xA; from extract_riskman.FRM_DATA &#xA; where fieldname ='PCAPrevCorActOth'&#xA; &#xA;  --populate action_due_date&#xA; insert into #action_temp_ddate&#xA; select distinct BatchID,  ValueDate&#xA; from extract_riskman.FRM_DATA &#xA; where fieldname ='PCAActImpDate'&#xA;     &#xA; --populate action_completed_date&#xA; insert into #action_temp_cdate&#xA; select distinct BatchID,  ValueDate&#xA; from extract_riskman.FRM_DATA &#xA;  where fieldname ='PCAActComDate'&#xA;&#xA;&#xA; --populate preventative_corrective_action&#xA; insert into #action_temp (batchid, pca)&#xA; select distinct BatchID, action&#xA; from #action_temp_pca&#xA;&#xA; --populate specific_preventative_corrective_action&#xA; update t1&#xA; set t1.spca = t2.action&#xA; from #action_temp as t1&#xA; inner join #action_temp_spca &#x9;as t2 on t1.batchid=t2.BatchID&#xA; &#xA;  --populate action_due_date&#xA; update t1&#xA; set t1.due_date = convert(date,t2.vdate)&#xA; from #action_temp as t1&#xA; inner join #action_temp_ddate  t2 on t1.batchid=t2.BatchID &#xA;&#xA;   --populate action_completed_date&#xA; update t1&#xA; set t1.com_date = convert(date,t2.vdate)&#xA; from #action_temp as t1&#xA; inner join #action_temp_cdate  t2 on t1.batchid=t2.BatchID &#xA; where t2.vdate is not null&#xA;&#xA;&#xA;insert into conform_riskman.INCIDENT_ACTION_FACT&#xA;  select &#xA;  f1.incident_key,&#xA;  m.action_key&#xA;  from conform_riskman.incident_fact as f1&#xA;  inner join&#xA;&#xA;  (&#xA;&#xA;&#x9;  select &#xA;&#x9;    n2.CH_ID,&#xA;&#x9;&#x9;n1.action_key&#xA;&#x9;  from &#xA;&#xA;&#x9;  (&#xA;&#xA;&#x9;&#x9; select g1.*,&#xA;&#x9;&#x9;   ISNULL(dd1.action_key,(select action_key from  conform_riskman.action_dim where current_row_indicator='Y' and preventative_corrective_action='No Action Type'))  as action_key&#xA;&#x9;&#x9; from #action_temp as g1&#xA;&#x9;&#x9; left join &#xA;&#x9;&#x9; (&#xA;&#x9;&#x9;  select dd1.* &#xA;&#x9;&#x9;  from &#x9;conform_riskman.action_dim  as dd1&#xA;&#x9;&#x9;  inner join&#xA;&#x9;&#x9;&#x9; (&#xA;&#x9;&#x9;&#x9;  select preventative_corrective_action,specific_preventative_corrective_action,action_due_date,action_completed_date ,max(action_key) as action_key&#xA;&#x9;&#x9;&#x9; from conform_riskman.action_dim &#xA;&#x9;&#x9;&#x9; where current_row_indicator='Y' &#xA;&#x9;&#x9;&#x9; group by preventative_corrective_action,specific_preventative_corrective_action,action_due_date,action_completed_date &#xA;&#x9;&#x9;&#x9; ) &#x9;   as d1 &#xA;&#x9;&#x9;&#x9;on dd1.action_key=d1.action_key&#xA;&#x9;&#x9;  ) as dd1&#xA;&#x9;&#x9; on g1.pca=dd1.preventative_corrective_action  &#xA;&#x9;&#x9; and g1.spca =dd1.specific_preventative_corrective_action &#xA;&#x9;&#x9; and g1.due_date=dd1.action_due_date &#xA;&#x9;&#x9; and g1.com_date=dd1.action_completed_date &#xA;&#xA;&#x9;   ) as n1&#xA;&#x9;   inner join &#xA;&#x9;   (    select f1.ch_id, f1.PCARECID,f1.PCAPrevRECID,f2.KeyData,f3.RecordID,f3.BatchID&#xA;&#x9;&#x9; from extract_riskman.CH_IFR   as f1&#xA;&#x9;&#x9; inner join  extract_riskman.FRM_RECORD as f2 on f1.PCAPrevRECID=f2.KeyData&#xA;&#x9;&#x9; inner join &#x9; extract_riskman.FRM_BATCH&#x9; as f3 on f2.RecordID=f3.RecordID&#xA;      ) as n2 &#xA;&#x9;  on n1.batchid=n2.BatchID&#xA;&#xA;&#x9;  ) as m&#xA;&#x9;  on f1.id=m.CH_ID&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;----new method from VIEW changed by JS at 20/06/2017&#xA;&#xA;&#xA;  insert into conform_riskman.INCIDENT_ACTION_FACT&#xA;  select &#xA;  f1.incident_key,&#xA;  isnull(f2.action_key ,( select action_key from conform_riskman.action_dim&#x9; where preventative_corrective_action like 'No Action Type%'   and current_row_indicator='Y'))&#xA;  from conform_riskman.incident_fact as f1&#xA;  inner join conform_riskman.action_dim as f2&#xA;  on f1.id=f2.ch_id&#xA;&#xA;&#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{7dcb29ee-a3c3-4ee2-aed2-882358ca2252}"
              DTS:From="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\EST - Write Job Start info"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\Delete Existing Data" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{e3fbebaa-737e-44ae-914f-33c191ee1830}"
              DTS:From="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\Delete Existing Data"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\Populate new data" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT.PrecedenceConstraints[Constraint 2]"
              DTS:CreationName=""
              DTS:DTSID="{a9a4c1e4-999b-4398-8275-e4a8b7e0080d}"
              DTS:From="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\Populate new data"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 2"
              DTS:To="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\EST - Write Job Finish info" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{5bf58cad-7a80-44fa-a4e9-cb7e5a575b7c}"
              DTS:EventID="244"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{8b75493a-fe96-4a25-8b10-39171b548caa}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{31aa0825-11d4-4ef2-a318-40bf455916e2}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Execute SQL Task - Catch Error Details">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{E85ED4B0-760B-483B-A76C-D79EA17A6DAC}"
                      SQLTask:SqlStatementSource="-- insert into management.ERROR_EVENT_DETAIL_FACT table&#xA;&#xA;insert into management.ERROR_EVENT_DETAIL_FACT&#xA;SELECT &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,T2.TABLE_KEY&#xA;,T2.TABLE_KEY&#xA;,?&#xA;,' '&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;&#xA;-- insert into [management].ETL_PROCESS_FACT with 'Failed'&#xA;INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,3&#xA;,GETDATE() &#xA;,4&#xA;,'Update Fact Table'    &#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA; -- insert into management.ERROR_EVENT_FACT table&#xA;insert into management.ERROR_EVENT_FACT&#xA;SELECT &#xA;(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,convert(varchar, getdate(),21)&#xA;, 'HIGH'&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ParameterBinding
                        SQLTask:ParameterName="0"
                        SQLTask:DtsVariableName="System::ErrorDescription"
                        SQLTask:ParameterDirection="Input"
                        SQLTask:DataType="130"
                        SQLTask:ParameterSize="-1" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Sequence Container"
          DTS:DTSID="{b65cf5b5-c018-4059-9a09-669300e9c8ba}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="INCIDENT_TYPE_FACT">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\Delete Existing Data"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{df5f7044-2011-4d68-861a-b7004e58c3d5}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Delete Existing Data"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="truncate table conform_riskman.INCIDENT_TYPE_FACT" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\EST - Write Job Finish info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{e47cd150-4cb8-4edc-bd1c-39d9e51de8dc}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Finish info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,2&#xA;,GETDATE() ,&#xA;4,&#xA;'Finish updating FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_riskman.INCIDENT_TYPE_FACT'&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\EST - Write Job Start info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{519d7f4a-d95d-488f-8a74-f20e7ca454d0}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Start info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,1&#xA;,GETDATE() ,&#xA;4,&#xA;'Start to update FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_riskman.INCIDENT_TYPE_FACT'&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\Populate new data"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{10ebf5cf-3539-4b27-9da7-349c87d5061c}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Populate new data"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="--process definitions is not null&#xA; insert into   conform_riskman.INCIDENT_TYPE_FACT&#xA; select &#xA; f1.incident_key,&#xA; isnull(g1.incident_type_key, (select incident_type_key from conform_riskman.incident_type_dim  where current_row_indicator='Y' and super_group='No Incident Type' ))&#xA; from  conform_riskman.incident_fact as f1&#xA; inner join  &#xA; (&#xA;&#x9;  select t1.id, d1.incident_type_key&#xA;&#x9;  from &#x9;extract_riskman.IncidentClassificationsIFR as t1&#xA;&#x9;  inner join  conform_riskman.incident_type_dim as d1&#xA;&#x9;  on &#x9;  left(t1.Supergroup,50) =d1.super_group&#xA;       and left(t1.IncidentClass,50) =d1.incident_class&#xA;       and t1.Definitions is not NULL&#xA;&#x9;   and d1.definitions is not null&#xA;&#x9;   and left(t1.Definitions,50) = d1.definitions&#x9;&#x9; &#xA;&#xA; ) as g1&#xA; on f1.id=g1.ID&#xA;&#xA; --process definitions is  null&#xA; insert into   conform_riskman.INCIDENT_TYPE_FACT&#xA; select &#xA; f1.incident_key,&#xA; isnull(g1.incident_type_key, (select incident_type_key from conform_riskman.incident_type_dim  where current_row_indicator='Y' and super_group='No Incident Type' ))&#xA; from  conform_riskman.incident_fact as f1&#xA; inner join  &#xA; (&#xA;&#x9;  select t1.id, d1.incident_type_key&#xA;&#x9;  from &#x9;extract_riskman.IncidentClassificationsIFR as t1&#xA;&#x9;  inner join  conform_riskman.incident_type_dim as d1&#xA;&#x9;  on &#x9;  left(t1.Supergroup,50) =d1.super_group&#xA;       and left(t1.IncidentClass,50) =d1.incident_class&#xA;       and t1.Definitions is  NULL&#xA;&#x9;   and d1.definitions is  null&#xA;&#x9;  &#xA;&#xA; ) as g1&#xA; on f1.id=g1.ID" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{72571ca7-3d65-4af8-94aa-5902faa1b99a}"
              DTS:From="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\EST - Write Job Start info"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\Delete Existing Data" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{4e14fcdc-4ae4-435b-ad14-50068afdf18d}"
              DTS:From="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\Delete Existing Data"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\Populate new data" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT.PrecedenceConstraints[Constraint 2]"
              DTS:CreationName=""
              DTS:DTSID="{804b6f40-c013-478b-9697-ca983076b5aa}"
              DTS:From="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\Populate new data"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 2"
              DTS:To="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\EST - Write Job Finish info" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{9d086bbe-910e-4346-ba95-03de9281f611}"
              DTS:EventID="244"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{01cb21ff-17db-4594-b9b9-dc6f9bcb9d44}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{66e73b0c-7ea8-4bcb-936d-778807d7337e}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Execute SQL Task - Catch Error Details">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{E85ED4B0-760B-483B-A76C-D79EA17A6DAC}"
                      SQLTask:SqlStatementSource="-- insert into management.ERROR_EVENT_DETAIL_FACT table&#xA;&#xA;insert into management.ERROR_EVENT_DETAIL_FACT&#xA;SELECT &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,T2.TABLE_KEY&#xA;,T2.TABLE_KEY&#xA;,?&#xA;,' '&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;&#xA;-- insert into [management].ETL_PROCESS_FACT with 'Failed'&#xA;INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,3&#xA;,GETDATE() &#xA;,4&#xA;,'Update Fact Table'    &#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA; -- insert into management.ERROR_EVENT_FACT table&#xA;insert into management.ERROR_EVENT_FACT&#xA;SELECT &#xA;(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,convert(varchar, getdate(),21)&#xA;, 'HIGH'&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ParameterBinding
                        SQLTask:ParameterName="0"
                        SQLTask:DtsVariableName="System::ErrorDescription"
                        SQLTask:ParameterDirection="Input"
                        SQLTask:DataType="130"
                        SQLTask:ParameterSize="-1" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Sequence Container"
          DTS:Disabled="True"
          DTS:DTSID="{01BF9DD8-4E66-45F6-8B51-CA3140F251EA}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="SD1 - INCIDENT_FACT -- keep all records and with bridge tables">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\Delete Existing Data"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{5301CE0E-19A4-4B0E-9E39-6E80AA253E0E}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Delete Existing Data"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="--- need to change later just delete the data for yesterday&#xA;&#xA;truncate table conform_riskman.incident_type_bridge&#xA;truncate table conform_riskman.incident_action_bridge&#xA;delete from conform_riskman.incident_fact" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\EST - Write Job Finish info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{F3879AD3-8096-4FB9-AD9F-3B46BF5D8A8F}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Finish info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,2&#xA;,GETDATE() ,&#xA;4,&#xA;'Finish updating FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_riskman.incident_fact'&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\EST - Write Job Start info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{7E758419-FCEE-4035-95BA-B5F2587F9FFF}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Start info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,1&#xA;,GETDATE() ,&#xA;4,&#xA;'Start to update FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_riskman.incident_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\Populate new data"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{41B0D9E3-5438-447A-BF18-4A20B260CC68}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Populate new data"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource=" --delete old data&#xA;delete from  conform_riskman.incident_fact&#xA; --populate new data &#xA; insert into conform_riskman.incident_fact&#xA; select &#xA;  id&#xA; ,BaseID&#xA; ,(select employee_key from conform_riskman.employee_dim&#x9;where given_name='-' and current_row_indicator='Y') --default employee_key&#xA; ,(select person_key from conform_riskman.person_dim&#x9;where given_name='No Person' and current_row_indicator='Y') --default person_key&#xA; ,(select portfolio_key from conform_riskman.portfolio_dim&#x9;where portfolio_name='No Portfolio' and current_row_indicator='Y') -- default_portfolio_key&#xA; ,( select service_stream_key from conform_riskman.service_stream_dim&#x9;where service_stream_name='No Service Stream' and current_row_indicator='Y') --default service_stream_key&#xA; ,(select program_key from conform_riskman.program_dim&#x9;where program_name='No Program' and current_row_indicator='Y') --default_program_key&#xA; ,ISNULL((select date_key from conform_riskman.date_dim where full_date = DateClosed),(select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000'))&#xA; ,ISNULL((select date_key from conform_riskman.date_dim where full_date = IncidentDate)&#x9;,(select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000'))&#xA; ,ISNULL((select date_key from conform_riskman.date_dim where full_date = NotificationDate)  ,(select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000'))&#xA; ,ISNULL((select date_key from conform_riskman.date_dim where full_date = DateDeleted)&#x9;,(select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000'))&#xA; ,ISNULL((select date_key from conform_riskman.date_dim where full_date = DateEntered)&#x9; ,(select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000'))&#xA; ,(select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000')  --default date key for investigation_ini_date_key&#xA; , (select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000')  --default date key for investigation_completed_date_key&#xA; ,IncidentTime&#xA; , Age&#xA; , left(Outcome,20)&#xA; , left(Status,20)&#xA; , left(Program,50)&#xA; , case IncidentInvolved &#xA;   when '0' then 'No' &#xA;   when '1' then  'Yes' &#xA;   else convert(varchar(3),IncidentInvolved)&#xA;    end&#xA;&#xA; , case Deceased &#xA;   when '0' then 'No' &#xA;   when '1' then  'Yes' &#xA;   else convert(varchar(3),Deceased)&#xA;    end&#xA; , case CoronerNotified &#xA;   when '0' then 'No' &#xA;   when '1' then  'Yes' &#xA;   else convert(varchar(3),CoronerNotified)&#xA;    end&#xA;&#xA;  , case Autopsy &#xA;   when '0' then 'No' &#xA;   when '1' then  'Yes' &#xA;   else convert(varchar(3),Autopsy)&#xA;    end&#xA;&#xA; , case NextOfKinNotified &#xA;   when '0' then 'No' &#xA;   when '1' then  'Yes' &#xA;   else convert(varchar(3),NextOfKinNotified)&#xA;    end&#xA;&#xA;&#xA;&#x9;, left(NotificationReason,20)&#xA;&#x9;, left(TransferRequired,20)&#xA;&#x9;,left(EmployeeSite,50)&#xA;&#x9;,left(NatureOfInjury,50)&#xA;&#x9;, left(Description ,255)&#xA;&#x9;, left(StaffLostTimeHours,3)&#xA;&#x9;, 'No' -------- defulat value for investigation_initiated&#xA;&#x9;,StaffWorkcoveNotif&#xA;&#x9;,StaffInjury&#xA;&#x9;,'No'  -------- defulat value for preventative_corrective_action_required&#xA;    ,'No'  -------- defulat value for police_notified&#xA;&#x9;,'No'  -------- defulat value for fire_brigade_notified&#xA;&#x9;,'No'  -------- defulat value for ambulance__notified&#xA;&#x9;,'No'  -------- defulat value for human_services_notified&#xA;&#x9;,'No'  -------- defulat value for health_sa_notified&#xA;&#x9;,'No'  -------- defulat value for crisis_intervention_notified&#xA;&#x9;,'No'  -------- defulat value for carl_notified&#xA;&#x9;,'No'  -------- defulat value for ag_notified&#xA;    ,'No'  -------- defulat value for housing_regulator_notified&#xA;&#x9;,'No'  -------- defulat value for funder_notified&#xA;    ,'No'  -------- defulat value for parent_guardian_notified&#xA; from extract_riskman.IncidentsForReview &#xA;&#xA;&#xA;&#xA; --update   InvDate&#x9;and InvestCompDate&#x9;,  investigation_initiatede,PHNotif,ACATNotif&#x9;from ANGCARE_IFR&#xA; update t1&#xA; set   t1.investigation_initiated_date_key=d1.date_key&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.ANGCARE_IFR as t2&#x9; on t1.id=t2.ANGCARE_ID&#xA; inner join conform_riskman.date_dim as d1 on t2.InvDate =d1.full_date&#xA;&#xA;  update t1&#xA; set   t1.investigation_completed_date_key=d1.date_key&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.ANGCARE_IFR as t2&#x9; on t1.id=t2.ANGCARE_ID&#xA; inner join conform_riskman.date_dim as d1 on t2.InvestCompDate =d1.full_date&#xA;&#xA; update t1&#xA; set   t1.investigation_initiated=(case t2.InvInit&#x9; when '0' then 'No' when '1' then 'Yes' else  convert(varchar(3), t2.InvInit) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.ANGCARE_IFR as t2&#x9; on t1.id=t2.ANGCARE_ID&#xA;&#xA;&#xA; update t1&#xA; set   t1.health_sa_notified=(case t2.PHNotif&#x9; when '0' then 'No' when '1' then 'Yes' else   convert(varchar(3),t2.PHNotif) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.ANGCARE_IFR as t2&#x9; on t1.id=t2.ANGCARE_ID&#xA;&#xA;&#xA; update t1&#xA; set   t1.crisis_intervention_notified=(case t2.ACATNotif&#x9; when '0' then 'No' when '1' then 'Yes' else   convert(varchar(3),t2.ACATNotif) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.ANGCARE_IFR as t2&#x9; on t1.id=t2.ANGCARE_ID&#xA;&#xA;  --update preventative_corrective_action_required from ch_ifr table&#xA;&#xA; update t1&#xA; set   t1.preventative_corrective_action_required=(case t2.CHPrevActReq&#x9; when '0' then 'No' when '1' then 'Yes' else   convert(varchar(3),t2.CHPrevActReq) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.CH_IFR as t2&#x9; on t1.id=t2.CH_ID&#xA;&#xA; --update column based on &#x9;BEN_IFR&#xA;  update t1&#xA; set   t1.human_services_notified=(case t2.Vicdhs&#x9; when '0' then 'No' when '1' then 'Yes' else   convert(varchar(3),t2.Vicdhs) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.BEN_IFR as t2&#x9; on t1.id=t2.ben_id&#xA;&#xA; --update columns based on &#x9;IncNotif_IFR table&#xA; update t1&#xA; set   t1.police_notified=(case t2.PoliceNotif&#x9; when '0' then 'No' when '1' then 'Yes' else   convert(varchar(3),t2.PoliceNotif) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2&#x9; on t1.id=t2.incNotif_id&#xA;&#xA;  update t1&#xA; set   t1.fire_brigade_notified=(case t2.FireNotif&#x9; when '0' then 'No' when '1' then 'Yes' else   convert(varchar(3),t2.FireNotif) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2&#x9; on t1.id=t2.incNotif_id&#xA;&#xA;&#xA; &#xA;  update t1&#xA; set   t1.ambulance__notified=(case t2.AmbNotif&#x9; when '0' then 'No' when '1' then 'Yes' else   convert(varchar(3),t2.AmbNotif) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2&#x9; on t1.id=t2.incNotif_id&#xA;&#xA;&#xA;&#xA;   update t1&#xA; set   t1.carl_notified=(case t2.ChildAbuseNotif&#x9; when '0' then 'No' when '1' then 'Yes' else   convert(varchar(3),t2.ChildAbuseNotif) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2&#x9; on t1.id=t2.incNotif_id&#xA;&#xA;&#xA;&#xA;&#xA;    update t1&#xA; set   t1.ag_notified=(case t2.AGNotif&#x9; when '0' then 'No' when '1' then 'Yes' else   convert(varchar(3),t2.AGNotif) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2&#x9; on t1.id=t2.incNotif_id&#xA;&#xA;&#xA;&#xA;     update t1&#xA; set   t1.housing_regulator_notified=(case t2.HouseReg&#x9; when '0' then 'No' when '1' then 'Yes' else   convert(varchar(3),t2.HouseReg) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2&#x9; on t1.id=t2.incNotif_id&#xA;&#xA;  &#xA;     update t1&#xA; set   t1.funder_notified=(case t2.Funder&#x9; when '0' then 'No' when '1' then 'Yes' else   convert(varchar(3),t2.Funder) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2&#x9; on t1.id=t2.incNotif_id&#xA;&#xA;&#xA;      update t1&#xA; set   t1.parent_guardian_notified=(case t2.GuardNotif&#x9; when '0' then 'No' when '1' then 'Yes' else   convert(varchar(3),t2.GuardNotif) end)&#xA; from &#x9;conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2&#x9; on t1.id=t2.incNotif_id&#xA;&#xA;&#xA; --update person_key&#x9; &#xA; update t1&#xA; set   t1.person_key=t2.person_key&#xA; from conform_riskman.incident_fact as t1&#xA; inner join&#xA; (select  f1.id, d1.person_key&#xA;  from &#x9;extract_riskman.IncidentsForReview as f1&#xA;  inner join conform_riskman.person_dim as d1&#xA;  on left(f1.firstname,50) =d1.given_name&#xA;  and left(f1.surname,50) =d1.family_name&#xA;  and f1.DateOfBirth=d1.date_of_birth&#xA;  )&#x9; as t2&#xA;  on t1.id=t2.ID&#xA;&#xA;  -----------update logged_by_employee_key&#xA;  --frist: based on firstname and last name&#xA;  update t1&#xA;  set &#x9;t1.logged_by_employee_key =t2.employee_key&#xA;  from conform_riskman.incident_fact as t1&#xA;  inner join &#xA;  (&#xA;   select  g1.id, g2.employee_key&#xA;   from  extract_riskman.IncidentsForReview as g1&#xA;   inner join&#xA;    (select f1.userdisplayname,d1.employee_key ,f1.username&#xA;&#x9; from extract_riskman.UserProfile as f1&#xA;&#x9; inner join &#xA;&#x9;  conform_riskman.employee_dim as d1 &#xA;&#x9;  on f1.userdisplayname = d1.given_name+' '+d1.family_name&#xA;&#x9;  and d1.current_row_indicator='Y'&#xA;&#x9;  ) as g2&#xA;  on g1.username = g2.username &#xA;  ) as t2&#xA;  on t1.id =t2.id &#xA;&#xA;&#xA;    update t1&#xA;  set &#x9;t1.logged_by_employee_key =t2.employee_key&#xA;  from conform_riskman.incident_fact as t1&#xA;  inner join &#xA;  (&#xA;   select  g1.id, g2.employee_key&#xA;   from  extract_riskman.IncidentsForReview as g1&#xA;   inner join&#xA;    (select f1.userdisplayname,d1.employee_key ,f1.username&#xA;&#x9; from extract_riskman.UserProfile as f1&#xA;&#x9; inner join &#xA;&#x9;  conform_riskman.employee_dim as d1 &#xA;&#x9;  on f1.userdisplayname = d1.preferred_name+' '+d1.family_name&#xA;&#x9;  and d1.current_row_indicator='Y'&#xA;&#x9;  ) as g2&#xA;  on g1.username = g2.username &#xA;  ) as t2&#xA;  on t1.id =t2.id &#xA;&#xA;  --based on email:&#xA;&#xA;      update t1&#xA;  set &#x9;t1.logged_by_employee_key =t2.employee_key&#xA;  from conform_riskman.incident_fact as t1&#xA;  inner join &#xA;  (&#xA;   select  g1.id, g2.employee_key&#xA;   from  extract_riskman.IncidentsForReview as g1&#xA;   inner join&#xA;    (select f1.userdisplayname,d1.employee_key ,f1.username&#xA;&#x9; from extract_riskman.UserProfile as f1&#xA;&#x9; inner join &#xA;&#x9;  conform_riskman.employee_dim as d1 &#xA;&#x9;  on f1.email = d1.street_email1&#xA;&#x9;  and d1.current_row_indicator='Y'&#xA;&#x9;  ) as g2&#xA;  on g1.username = g2.username &#xA;  ) as t2&#xA;  on t1.id =t2.id &#xA;&#xA;&#xA;-------------------------------------------------------populate org structure------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xA;&#xA;--populate program_key&#xA;&#xA;   --if site is null just use incident_location&#xA;   update t1&#xA;   set &#x9; t1.program_key=t2.program_key&#xA;   from   conform_riskman.incident_fact as t1&#xA;   inner join&#xA;   (&#xA;&#xA;&#x9; select f1.id,f1.baseid,f2.program_key&#xA;&#x9; from extract_riskman.IncidentsForReview &#x9;as f1&#xA;&#x9; inner join  conform_riskman.program_mapping as f2&#xA;&#x9; on f1.Incident_Location=f2.incident_location&#xA;&#x9; where f1.Site is null &#xA;&#x9; and f2.site is null&#xA;&#x9; and f2.program_key is not null&#xA;&#xA;&#x9;) as t2&#xA;&#x9;on t1.id =t2.id &#xA;&#x9;and t1.base_id=t2.BaseID&#xA;&#xA;   --if site is not null use site and incident_location&#xA;&#xA;&#x9;update t1&#xA;   set &#x9; t1.program_key=t2.program_key&#xA;   from   conform_riskman.incident_fact as t1&#xA;   inner join&#xA;   (&#xA;&#xA;&#x9; select f1.id,f1.baseid,f2.program_key&#xA;&#x9; from extract_riskman.IncidentsForReview &#x9;as f1&#xA;&#x9; inner join  conform_riskman.program_mapping as f2&#xA;&#x9; on f1.Incident_Location=f2.incident_location&#xA;&#x9; and f1.Site=f2.site&#xA;&#x9; where f1.Site is not null &#xA;&#x9; and f2.site is not null&#xA;&#x9; and f2.program_key is not null&#xA;&#xA;&#x9;) as t2&#xA;&#x9;on t1.id =t2.id &#xA;&#x9;and t1.base_id=t2.BaseID&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;----update service_stream_key and portfolio_key&#xA;&#xA;update k&#xA; set   k.service_stream_key=i.service_stream_key, k.portfolio_key=i.portfolio_key&#xA; from &#x9; conform_riskman.incident_fact as k&#xA; inner join&#xA;(&#xA;select &#xA;&#x9;n1.incident_key,&#xA;&#x9;n1.program_name,&#xA;&#x9;n1.service_stream_name,&#xA;&#x9;n1.portfolio_name,&#xA;&#x9;dd1.service_stream_key,&#xA;&#x9;dd2.portfolio_key&#xA;&#xA;&#xA;from&#xA;(&#xA;select &#x9; g2.incident_key,f2.program_name,f2.service_stream_name,f2.portfolio_name&#xA;from &#xA;(&#xA;select &#x9;f1.incident_key, g1.program_name&#xA;from conform_riskman.incident_fact as f1&#xA;inner join conform_riskman.program_dim as g1 on f1.program_key=g1.program_key and g1.current_row_indicator='Y'&#xA;) as g2&#xA;inner join &#xA;&#xA;&#xA;(&#xA;--get all org based on names&#xA;select distinct t1.program_code,t1.service_stream_code,t2.portfolio_code&#x9;, d1.program_name  ,d2.service_stream_name ,d3.portfolio_name ,d1.program_key,d2.service_stream_key,d3.portfolio_key&#xA;from conform.program_temp  as t1&#xA;inner join conform.service_stream_temp as t2   on t1.service_stream_code=t2.service_stream_code&#xA;inner join conform.program_dim as d1 on t1.program_code=d1.program_code and d1.current_row_indicator='Y'&#xA;inner join conform.service_stream_dim as d2 on t1.service_stream_code=d2.service_stream_code and d1.current_row_indicator='Y'&#xA;inner join conform.portfolio_dim as d3 on t2.portfolio_code=d3.portfolio_code and d1.current_row_indicator='Y'&#xA;)  as f2 on g2.program_name=f2.program_name&#xA;) as n1&#xA;inner join conform_riskman.service_stream_dim as dd1 on dd1.service_stream_name=n1.service_stream_name and dd1.current_row_indicator='Y'&#xA;inner join conform_riskman.portfolio_dim as dd2 on dd2.portfolio_name=n1.portfolio_name and dd1.current_row_indicator='Y'&#xA;) as i &#xA;on k.incident_key=i.incident_key&#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{9A5124C7-256E-41A9-87F6-62486EB281EE}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\EST - Write Job Start info"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\Delete Existing Data" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{296E7060-C6E7-4544-93B2-713C3F34A3CD}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\Delete Existing Data"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\Populate new data" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables.PrecedenceConstraints[Constraint 2]"
              DTS:CreationName=""
              DTS:DTSID="{A47CE230-1E1D-4360-8A57-70EAC75A0C1E}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\Populate new data"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 2"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\EST - Write Job Finish info" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{DABC7BB5-25F2-4B93-B4DB-1607996CF151}"
              DTS:EventID="244"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{76D808F6-172D-4CDF-B3A3-FFDC7CACC624}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{BCFD069E-DC97-4D9A-AD2B-37AAB56B7BC3}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Execute SQL Task - Catch Error Details">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{E85ED4B0-760B-483B-A76C-D79EA17A6DAC}"
                      SQLTask:SqlStatementSource="-- insert into management.ERROR_EVENT_DETAIL_FACT table&#xA;&#xA;insert into management.ERROR_EVENT_DETAIL_FACT&#xA;SELECT &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,T2.TABLE_KEY&#xA;,T2.TABLE_KEY&#xA;,?&#xA;,' '&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;&#xA;-- insert into [management].ETL_PROCESS_FACT with 'Failed'&#xA;INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,3&#xA;,GETDATE() &#xA;,4&#xA;,'Update Fact Table'    &#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA; -- insert into management.ERROR_EVENT_FACT table&#xA;insert into management.ERROR_EVENT_FACT&#xA;SELECT &#xA;(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,convert(varchar, getdate(),21)&#xA;, 'HIGH'&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ParameterBinding
                        SQLTask:ParameterName="0"
                        SQLTask:DtsVariableName="System::ErrorDescription"
                        SQLTask:ParameterDirection="Input"
                        SQLTask:DataType="130"
                        SQLTask:ParameterSize="-1" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Sequence Container"
          DTS:DTSID="{94ed87e7-f4d5-4be9-8fdf-3efbc23ef736}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="SD1 - INCIDENT_FACT -- Keep one record for one incident">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\Delete Existing Data"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{8c5b8525-98a2-491d-8e83-cada9af26f2a}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Delete Existing Data"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="--- need to change later just delete the data for yesterday&#xA;&#xA;&#xA;truncate table conform_riskman.INCIDENT_TYPE_FACT&#xA;&#xA;truncate table conform_riskman.INCIDENT_ACTION_FACT&#xA;&#xA;truncate table &#x9;conform_riskman.INCIDENT_HISTORY_FACT&#xA;&#xA;delete from  conform_riskman.incident_fact&#xA;&#xA;----below code is for setting the primary key on 1&#xA;DBCC CHECKIDENT ('conform_riskman.incident_fact', reseed, 1)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\EST - Write Job Finish info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{be56b18c-138a-4d07-a49b-e08539a70fa8}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Finish info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,2&#xA;,GETDATE() ,&#xA;4,&#xA;'Finish updating FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_riskman.incident_fact'&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\EST - Write Job Start info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{cd7323b3-5075-4068-a414-7440032a984c}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Start info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,1&#xA;,GETDATE() ,&#xA;4,&#xA;'Start to update FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_riskman.incident_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\Populate new data"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{de996072-3bcc-4556-8825-ada6e8523c3e}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Populate new data"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="&#xA;&#xA; --populate new data &#xA; insert into conform_riskman.incident_fact&#xA; select &#xA;  t1.id&#xA; ,t1.BaseID&#xA; ,t1.DisplayID&#xA; --,(select employee_key from conform_riskman.employee_dim where given_name='-' and current_row_indicator='Y') --default employee_key&#xA; ,(select person_key from conform_riskman.person_dim where given_name='No Person' and current_row_indicator='Y') --default person_key&#xA; ,(select portfolio_key from conform_riskman.portfolio_dim where portfolio_name='No Portfolio' and current_row_indicator='Y') -- default_portfolio_key&#xA; ,( select service_stream_key from conform_riskman.service_stream_dim where service_stream_name='No Service Stream' and current_row_indicator='Y') --default service_stream_key&#xA; ,(select program_key from conform_riskman.program_dim where program_name='No Program' and current_row_indicator='Y') --default_program_key&#xA; ,ISNULL((select date_key from conform_riskman.date_dim where full_date = t1.DateClosed),(select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000'))&#xA; ,ISNULL((select date_key from conform_riskman.date_dim where full_date = t1.IncidentDate) ,(select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000'))&#xA; ,ISNULL((select date_key from conform_riskman.date_dim where full_date = t1.NotificationDate)  ,(select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000'))&#xA; ,ISNULL((select date_key from conform_riskman.date_dim where full_date = t1.DateDeleted) ,(select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000'))&#xA; --,ISNULL((select date_key from conform_riskman.date_dim where full_date = t1.DateEntered)  ,(select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000'))&#xA; ,(select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000')  --default date key for investigation_ini_date_key&#xA; , (select date_key from conform_riskman.date_dim where full_date = '1800-01-01 00:00:00.000')  --default date key for investigation_completed_date_key&#xA; ,t1.IncidentTime&#xA; , t1.Age&#xA; , left(t1.Outcome,20)&#xA; , left(t1.Status,20)&#xA;,left(t1.incident_location,50)&#xA; , left(t1.Program,50)&#xA; ,left( t1.IncidentInvolved ,50)&#xA; , case t1.Deceased &#xA;   when '0' then 'No' &#xA;   when '1' then  'Yes' &#xA;   else 'No'&#xA;    end&#xA; , case t1.CoronerNotified &#xA;   when '0' then 'No' &#xA;   when '1' then  'Yes' &#xA;   else 'No'&#xA;    end&#xA;&#xA;  , case t1.Autopsy &#xA;   when '0' then 'No' &#xA;   when '1' then  'Yes' &#xA;   else 'No'&#xA;    end&#xA;&#xA; , case t1.NextOfKinNotified &#xA;   when '0' then 'No' &#xA;   when '1' then  'Yes' &#xA;   else 'No'&#xA;    end&#xA;&#xA;&#xA; , left(t1.NotificationReason,20)&#xA; , left(t1.TransferRequired,20)&#xA; ,left(t1.EmployeeSite,50)&#xA; ,left(t1.NatureOfInjury,50)&#xA; , left(t1.Description ,255)&#xA; , left(t1.StaffLostTimeHours,3)&#xA; , 'No' -------- defulat value for investigation_initiated&#xA; ,case t1.StaffWorkcoveNotif   when '0' then 'No' when '1' then 'Yes' else 'No' end as &#x9;safeworksa&#xA; ---,t1.StaffInjury&#xA;, case when len(t1.NatureOfInjury)&lt;&gt;0  then 'Yes' else 'No' end&#xA; ,'No'  -------- defulat value for preventative_corrective_action_required&#xA;    ,'No'  -------- defulat value for police_notified&#xA; ,'No'  -------- defulat value for fire_brigade_notified&#xA; ,'No'  -------- defulat value for ambulance__notified&#xA; ,'No'  -------- defulat value for human_services_notified&#xA; ,'No'  -------- defulat value for health_sa_notified&#xA; ,'No'  -------- defulat value for crisis_intervention_notified&#xA; ,'No'  -------- defulat value for carl_notified&#xA; ,'No'  -------- defulat value for ag_notified&#xA;    ,'No'  -------- defulat value for housing_regulator_notified&#xA; ,'No'  -------- defulat value for funder_notified&#xA;    ,'No'  -------- defulat value for parent_guardian_notified&#xA;,left(t1.detail,255)&#xA;,''&#xA;,'' &#xA;&#xA; from extract_riskman.IncidentsForReview  as t1&#xA; inner join&#xA; (select BaseID,max(SequenceNo) as SequenceNo&#xA; from extract_riskman.IncidentsForReview&#xA; group by  BaseID&#xA; ) as t2&#xA; on  t1.baseid = t2.baseid &#xA; and t1.SequenceNo=t2.SequenceNo&#xA;&#xA;&#xA;&#xA; --update   InvDate and InvestCompDate ,  investigation_initiatede,PHNotif,ACATNotif from ANGCARE_IFR&#xA; update t1&#xA; set   t1.investigation_initiated_date_key=d1.date_key&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.ANGCARE_IFR as t2  on t1.id=t2.ANGCARE_ID&#xA; inner join conform_riskman.date_dim as d1 on t2.InvDate =d1.full_date&#xA;&#xA;&#xA; update t1&#xA; set   t1.cust_service=t2.custService, t1.customer_site=t2.customerSite&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.ANGCARE_IFR as t2  on t1.id=t2.ANGCARE_ID&#xA;&#xA;&#xA;&#xA;  update t1&#xA; set   t1.investigation_completed_date_key=d1.date_key&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.ANGCARE_IFR as t2  on t1.id=t2.ANGCARE_ID&#xA; inner join conform_riskman.date_dim as d1 on t2.InvestCompDate =d1.full_date&#xA;&#xA; update t1&#xA; set   t1.investigation_initiated=(case t2.InvInit  when '0' then 'No' when '1' then 'Yes' else  'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.ANGCARE_IFR as t2  on t1.id=t2.ANGCARE_ID&#xA;&#xA;&#xA; update t1&#xA; set   t1.health_sa_notified=(case t2.PHNotif  when '0' then 'No' when '1' then 'Yes' else   'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.ANGCARE_IFR as t2  on t1.id=t2.ANGCARE_ID&#xA;&#xA;&#xA; update t1&#xA; set   t1.crisis_intervention_notified=(case t2.ACATNotif  when '0' then 'No' when '1' then 'Yes' else   'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.ANGCARE_IFR as t2  on t1.id=t2.ANGCARE_ID&#xA;&#xA;  --update preventative_corrective_action_required from ch_ifr table&#xA;&#xA; update t1&#xA; set   t1.preventative_corrective_action_required=(case t2.CHPrevActReq  when '0' then 'No' when '1' then 'Yes' else  'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.CH_IFR as t2  on t1.id=t2.CH_ID&#xA;&#xA; --update column based on  BEN_IFR&#xA;  update t1&#xA; set   t1.human_services_notified=(case t2.Vicdhs  when '0' then 'No' when '1' then 'Yes' else  'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.BEN_IFR as t2  on t1.id=t2.ben_id&#xA;&#xA; --update columns based on  IncNotif_IFR table&#xA; update t1&#xA; set   t1.police_notified=(case t2.PoliceNotif  when '0' then 'No' when '1' then 'Yes' else  'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2  on t1.id=t2.incNotif_id&#xA;&#xA;  update t1&#xA; set   t1.fire_brigade_notified=(case t2.FireNotif  when '0' then 'No' when '1' then 'Yes' else  'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2  on t1.id=t2.incNotif_id&#xA;&#xA;&#xA; &#xA;  update t1&#xA; set   t1.ambulance__notified=(case t2.AmbNotif  when '0' then 'No' when '1' then 'Yes' else   'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2  on t1.id=t2.incNotif_id&#xA;&#xA;&#xA;&#xA;   update t1&#xA; set   t1.carl_notified=(case t2.ChildAbuseNotif  when '0' then 'No' when '1' then 'Yes' else   'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2  on t1.id=t2.incNotif_id&#xA;&#xA;&#xA;&#xA;&#xA;    update t1&#xA; set   t1.ag_notified=(case t2.AGNotif  when '0' then 'No' when '1' then 'Yes' else   'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2  on t1.id=t2.incNotif_id&#xA;&#xA;&#xA;&#xA;     update t1&#xA; set   t1.housing_regulator_notified=(case t2.HouseReg  when '0' then 'No' when '1' then 'Yes' else   'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2  on t1.id=t2.incNotif_id&#xA;&#xA;  &#xA;     update t1&#xA; set   t1.funder_notified=(case t2.Funder  when '0' then 'No' when '1' then 'Yes' else   'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2  on t1.id=t2.incNotif_id&#xA;&#xA;&#xA;      update t1&#xA; set   t1.parent_guardian_notified=(case t2.GuardNotif  when '0' then 'No' when '1' then 'Yes' else   'No' end)&#xA; from  conform_riskman.incident_fact as t1&#xA; inner join extract_riskman.IncNotif_IFR as t2  on t1.id=t2.incNotif_id&#xA;&#xA;&#xA; --update person_key  &#xA; update t1&#xA; set   t1.person_key=t2.person_key&#xA; from conform_riskman.incident_fact as t1&#xA; inner join&#xA; (select  f1.id, d1.person_key&#xA;  from  extract_riskman.IncidentsForReview as f1&#xA;  inner join conform_riskman.person_dim as d1&#xA;  on left(f1.firstname,50) =d1.given_name&#xA;  and left(f1.surname,50) =d1.family_name&#xA;  ---and f1.DateOfBirth=d1.date_of_birth&#xA;  )  as t2&#xA;  on t1.id=t2.ID&#xA;&#xA;  /*-----------update logged_by_employee_key&#xA;  --frist: based on firstname and last name&#xA;  update t1&#xA;  set  t1.logged_by_employee_key =t2.employee_key&#xA;  from conform_riskman.incident_fact as t1&#xA;  inner join &#xA;  (&#xA;   select  g1.id, g2.employee_key&#xA;   from  extract_riskman.IncidentsForReview as g1&#xA;   inner join&#xA;    (select f1.userdisplayname,d1.employee_key ,f1.username&#xA;  from extract_riskman.UserProfile as f1&#xA;  inner join &#xA;   conform_riskman.employee_dim as d1 &#xA;   on f1.userdisplayname = d1.given_name+' '+d1.family_name&#xA;   and d1.current_row_indicator='Y'&#xA;   ) as g2&#xA;  on g1.username = g2.username &#xA;  ) as t2&#xA;  on t1.id =t2.id &#xA;&#xA;&#xA;    update t1&#xA;  set  t1.logged_by_employee_key =t2.employee_key&#xA;  from conform_riskman.incident_fact as t1&#xA;  inner join &#xA;  (&#xA;   select  g1.id, g2.employee_key&#xA;   from  extract_riskman.IncidentsForReview as g1&#xA;   inner join&#xA;    (select f1.userdisplayname,d1.employee_key ,f1.username&#xA;  from extract_riskman.UserProfile as f1&#xA;  inner join &#xA;   conform_riskman.employee_dim as d1 &#xA;   on f1.userdisplayname = d1.preferred_name+' '+d1.family_name&#xA;   and d1.current_row_indicator='Y'&#xA;   ) as g2&#xA;  on g1.username = g2.username &#xA;  ) as t2&#xA;  on t1.id =t2.id &#xA;&#xA;  --based on email:&#xA;&#xA;      update t1&#xA;  set  t1.logged_by_employee_key =t2.employee_key&#xA;  from conform_riskman.incident_fact as t1&#xA;  inner join &#xA;  (&#xA;   select  g1.id, g2.employee_key&#xA;   from  extract_riskman.IncidentsForReview as g1&#xA;   inner join&#xA;    (select f1.userdisplayname,d1.employee_key ,f1.username&#xA;  from extract_riskman.UserProfile as f1&#xA;  inner join &#xA;   conform_riskman.employee_dim as d1 &#xA;   on f1.email = d1.street_email1&#xA;   and d1.current_row_indicator='Y'&#xA;   ) as g2&#xA;  on g1.username = g2.username &#xA;  ) as t2&#xA;  on t1.id =t2.id &#xA;  */&#xA;&#xA;-------------------------------------------------------populate org structure------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xA;&#xA;--populate program_key&#xA;&#xA;/*&#xA;&#xA;   --if site is null just use incident_location&#xA;   update t1&#xA;   set   t1.program_key=t2.program_key&#xA;   from   conform_riskman.incident_fact as t1&#xA;   inner join&#xA;   (&#xA;&#xA;  select f1.id,f1.baseid,f2.program_key&#xA;  from extract_riskman.IncidentsForReview  as f1&#xA;  inner join  conform_riskman.program_mapping as f2&#xA;  on f1.Incident_Location=f2.incident_location&#xA;  where f1.Site is null &#xA;  and f2.site is null&#xA;  and f2.program_key is not null&#xA;&#xA; ) as t2&#xA; on t1.id =t2.id &#xA; and t1.base_id=t2.BaseID&#xA;&#xA;   --if site is not null use site and incident_location&#xA;&#xA; update t1&#xA;   set   t1.program_key=t2.program_key&#xA;   from   conform_riskman.incident_fact as t1&#xA;   inner join&#xA;   (&#xA;&#xA;  select f1.id,f1.baseid,f2.program_key&#xA;  from extract_riskman.IncidentsForReview  as f1&#xA;  inner join  conform_riskman.program_mapping as f2&#xA;  on f1.Incident_Location=f2.incident_location&#xA;  and f1.Site=f2.site&#xA;  where f1.Site is not null &#xA;  and f2.site is not null&#xA;  and f2.program_key is not null&#xA;&#xA; ) as t2&#xA; on t1.id =t2.id &#xA; and t1.base_id=t2.BaseID&#xA;*/&#xA;&#xA;-------------------------------------------------------------------------------------------------------------Org mapping using four ways-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xA;---------------------------------------------------------------------------------WAY1: using  ANGCARE_IFR.CustService---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xA;&#xA;--changed by JS at 23/05/2017 based on table- ANGCARE_IFR.CustService&#xA;---Step1: update CustomerSite type = program&#xA;update t1&#xA;   set   t1.program_key=t2.program_key&#xA;   from   conform_riskman.incident_fact as t1&#xA;   inner join&#xA;   (&#xA;&#xA;  select f1.id,f1.baseid,f2.program_key&#xA;  from extract_riskman.IncidentsForReview  as f1&#xA;  inner join extract_riskman.ANGCARE_IFR as f3 on f1.id =f3.ANGCARE_ID&#xA;  inner join  conform_riskman.program_mapping as f2&#x9;    on f3.CustService=f2.value1&#xA;  where f2.program_key is not null  and  f2.mapping_type='Program' and f2.system='Riskman' and f2.table1='ANGCARE_IFR'&#xA;&#xA; ) as t2&#xA; on t1.id =t2.id &#xA; and t1.base_id=t2.BaseID&#xA;where  t1.program_key=(select program_key from conform_riskman.program_dim where current_row_indicator='Y' and program_name ='No Program')&#xA;&#xA;&#xA;&#xA;&#xA;----update service_stream_key and portfolio_key&#xA;&#xA;update k&#xA; set   k.service_stream_key=i.service_stream_key, k.portfolio_key=i.portfolio_key&#xA; from   conform_riskman.incident_fact as k&#xA; inner join&#xA;(&#xA;select &#xA; n1.incident_key,&#xA; n1.program_name,&#xA; n1.service_stream_name,&#xA; n1.portfolio_name,&#xA; dd1.service_stream_key,&#xA; dd2.portfolio_key&#xA;&#xA;&#xA;from&#xA;(&#xA;select   g2.incident_key,f2.program_name,f2.service_stream_name,f2.portfolio_name&#xA;from &#xA;(&#xA;select  f1.incident_key, g1.program_name&#xA;from conform_riskman.incident_fact as f1&#xA;inner join conform_riskman.program_dim as g1 on f1.program_key=g1.program_key and g1.current_row_indicator='Y'&#xA;) as g2&#xA;inner join &#xA;&#xA;&#xA;(&#xA;--get all org based on names&#xA;select distinct t1.program_code,t1.service_stream_code,t2.portfolio_code , d1.program_name  ,d2.service_stream_name ,d3.portfolio_name ,d1.program_key,d2.service_stream_key,d3.portfolio_key&#xA;from conform.program_temp  as t1&#xA;inner join conform.service_stream_temp as t2   on t1.service_stream_code=t2.service_stream_code&#xA;inner join conform.program_dim as d1 on t1.program_code=d1.program_code and d1.current_row_indicator='Y'&#xA;inner join conform.service_stream_dim as d2 on t1.service_stream_code=d2.service_stream_code and d1.current_row_indicator='Y'&#xA;inner join conform.portfolio_dim as d3 on t2.portfolio_code=d3.portfolio_code and d1.current_row_indicator='Y'&#xA;)  as f2 on g2.program_name=f2.program_name&#xA;) as n1&#xA;inner join conform_riskman.service_stream_dim as dd1 on dd1.service_stream_name=n1.service_stream_name and dd1.current_row_indicator='Y'&#xA;inner join conform_riskman.portfolio_dim as dd2 on dd2.portfolio_name=n1.portfolio_name and dd1.current_row_indicator='Y'&#xA;) as i &#xA;on k.incident_key=i.incident_key&#xA;&#xA;&#xA;&#xA;----------Step2: update CustomerSite type = Service Stream&#xA;&#xA; update t1&#xA;   set   t1.portfolio_key= (case t2.program_name&#xA;                           when   'Community Services' then (select portfolio_key from conform_riskman.portfolio_dim where portfolio_name='Community Services')&#xA;                           when 'Community Engagement' then   (select portfolio_key from conform_riskman.portfolio_dim where portfolio_name='Aboriginal Services')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   when 'Residental Aged Care' then   (select portfolio_key from conform_riskman.portfolio_dim where portfolio_name='Active Living')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   end&#x9;),&#xA;                         &#xA;        t1.service_stream_key= t2.service_stream_key,&#xA;&#x9;&#x9;t1.program_key=(select program_key from conform_riskman.program_dim where current_row_indicator='Y'  and program_name ='No Program')  &#xA;    &#xA;   from   conform_riskman.incident_fact as t1&#xA;   inner join&#xA;   (&#xA;&#xA;  select f1.id,f1.baseid ,f2.*&#x9;,d1.service_stream_key&#xA;  from extract_riskman.IncidentsForReview  as f1&#xA;  inner join extract_riskman.ANGCARE_IFR as f3 on f1.id =f3.ANGCARE_ID&#xA;  inner join  conform_riskman.program_mapping as f2&#x9;    on f3.CustService=f2.value1&#xA;  inner join conform_riskman.service_stream_dim as d1 on d1.service_stream_name=f2.program_name&#x9;  and d1.current_row_indicator='Y'&#xA;  where f2.mapping_type='Service Stream' and f2.system='Riskman' and f2.table1='ANGCARE_IFR'&#xA;&#xA; ) as t2&#xA; on t1.id =t2.id &#xA; and t1.base_id=t2.BaseID&#xA;&#xA;&#xA;&#xA;----------Step3: update CustomerSite type = Portfolio&#xA;&#xA;&#xA; &#x9;update t1&#xA;   set   t1.portfolio_key=t2.portfolio_key ,&#xA;        t1.service_stream_key= (select service_stream_key from conform_riskman.service_stream_dim where current_row_indicator='Y'  and service_stream_name ='No Service Stream')  ,&#xA;&#x9;&#x9;t1.program_key=(select program_key from conform_riskman.program_dim where current_row_indicator='Y'  and program_name ='No Program')  &#xA;    &#xA;   from   conform_riskman.incident_fact as t1&#xA;   inner join&#xA;   (&#xA;&#xA;  select f1.id,f1.baseid ,f2.*&#x9;,d1.portfolio_key&#xA;  from extract_riskman.IncidentsForReview  as f1&#xA;  inner join extract_riskman.ANGCARE_IFR as f3 on f1.id =f3.ANGCARE_ID&#xA;  inner join  conform_riskman.program_mapping as f2&#x9;    on f3.CustService=f2.value1&#xA;  inner join conform_riskman.portfolio_dim as d1 on d1.portfolio_name=f2.program_name and d1.current_row_indicator='Y'&#xA;  where f2.mapping_type='Portfolio'&#x9;  and f2.system='Riskman' and f2.table1='ANGCARE_IFR'&#xA;&#xA; ) as t2&#xA; on t1.id =t2.id &#xA; and t1.base_id=t2.BaseID&#xA;&#xA;&#xA;&#xA;----------------------------------------WAY2: using  IncidentsForReview.EmployeeSite -----------------------------------------------------------------------------------------------------------------------------------------------------&#xA;&#xA;---Step1: update CustomerSite type = program&#xA;update t1&#xA;   set   t1.program_key=t2.program_key&#xA;   from   conform_riskman.incident_fact as t1&#xA;   inner join&#xA;   (&#xA;&#xA;  select f1.id,f1.baseid,f2.program_key&#xA;  from extract_riskman.IncidentsForReview  as f1&#xA;   inner join  conform_riskman.program_mapping as f2&#x9;    on f1.EmployeeSite=f2.value1&#xA;  where f2.program_key is not null  and  f2.mapping_type='Program' and f2.system='Riskman' and f2.table1='IncidentsForReview'&#xA;&#xA; ) as t2&#xA; on t1.id =t2.id &#xA; and t1.base_id=t2.BaseID&#xA;where  t1.program_key=(select program_key from conform_riskman.program_dim where current_row_indicator='Y' and program_name ='No Program')&#xA;&#xA;&#xA;----update service_stream_key and portfolio_key&#xA;&#xA;update k&#xA; set   k.service_stream_key=i.service_stream_key, k.portfolio_key=i.portfolio_key&#xA; from   conform_riskman.incident_fact as k&#xA; inner join&#xA;(&#xA;select &#xA; n1.incident_key,&#xA; n1.program_name,&#xA; n1.service_stream_name,&#xA; n1.portfolio_name,&#xA; dd1.service_stream_key,&#xA; dd2.portfolio_key&#xA;&#xA;&#xA;from&#xA;(&#xA;select   g2.incident_key,f2.program_name,f2.service_stream_name,f2.portfolio_name&#xA;from &#xA;(&#xA;select  f1.incident_key, g1.program_name&#xA;from conform_riskman.incident_fact as f1&#xA;inner join conform_riskman.program_dim as g1 on f1.program_key=g1.program_key and g1.current_row_indicator='Y'&#xA;) as g2&#xA;inner join &#xA;&#xA;&#xA;(&#xA;--get all org based on names&#xA;select distinct t1.program_code,t1.service_stream_code,t2.portfolio_code , d1.program_name  ,d2.service_stream_name ,d3.portfolio_name ,d1.program_key,d2.service_stream_key,d3.portfolio_key&#xA;from conform.program_temp  as t1&#xA;inner join conform.service_stream_temp as t2   on t1.service_stream_code=t2.service_stream_code&#xA;inner join conform.program_dim as d1 on t1.program_code=d1.program_code and d1.current_row_indicator='Y'&#xA;inner join conform.service_stream_dim as d2 on t1.service_stream_code=d2.service_stream_code and d1.current_row_indicator='Y'&#xA;inner join conform.portfolio_dim as d3 on t2.portfolio_code=d3.portfolio_code and d1.current_row_indicator='Y'&#xA;)  as f2 on g2.program_name=f2.program_name&#xA;) as n1&#xA;inner join conform_riskman.service_stream_dim as dd1 on dd1.service_stream_name=n1.service_stream_name and dd1.current_row_indicator='Y'&#xA;inner join conform_riskman.portfolio_dim as dd2 on dd2.portfolio_name=n1.portfolio_name and dd1.current_row_indicator='Y'&#xA;) as i &#xA;on k.incident_key=i.incident_key&#xA;&#xA;&#xA;&#xA;----------Step2: update CustomerSite type = Service Stream&#xA;&#xA; update t1&#xA;   set   t1.portfolio_key= (case t2.program_name&#xA;                           when   'Community Services' then (select portfolio_key from conform_riskman.portfolio_dim where portfolio_name='Community Services')&#xA;                           when 'Community Engagement' then   (select portfolio_key from conform_riskman.portfolio_dim where portfolio_name='Aboriginal Services')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   when 'Residental Aged Care' then   (select portfolio_key from conform_riskman.portfolio_dim where portfolio_name='Active Living')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   end&#x9;),&#xA;                         &#xA;        t1.service_stream_key= t2.service_stream_key,&#xA;&#x9;&#x9;t1.program_key=(select program_key from conform_riskman.program_dim where current_row_indicator='Y'  and program_name ='No Program')  &#xA;    &#xA;   from   conform_riskman.incident_fact as t1&#xA;   inner join&#xA;   (&#xA;&#xA;  select f1.id,f1.baseid ,f2.*&#x9;,d1.service_stream_key&#xA;   from extract_riskman.IncidentsForReview  as f1&#xA;   inner join  conform_riskman.program_mapping as f2&#x9;    on f1.EmployeeSite=f2.value1&#xA;  inner join conform_riskman.service_stream_dim as d1 on d1.service_stream_name=f2.program_name&#x9;  and d1.current_row_indicator='Y'&#xA;  where f2.mapping_type='Service Stream' and f2.system='Riskman' and f2.table1='ANGCARE_IFR'&#xA;&#xA; ) as t2&#xA; on t1.id =t2.id &#xA; and t1.base_id=t2.BaseID&#xA;&#xA;&#xA;&#xA;----------Step3: update CustomerSite type = Portfolio&#xA;&#xA;&#xA; &#x9;update t1&#xA;   set   t1.portfolio_key=t2.portfolio_key ,&#xA;        t1.service_stream_key= (select service_stream_key from conform_riskman.service_stream_dim where current_row_indicator='Y'  and service_stream_name ='No Service Stream')  ,&#xA;&#x9;&#x9;t1.program_key=(select program_key from conform_riskman.program_dim where current_row_indicator='Y'  and program_name ='No Program')  &#xA;    &#xA;   from   conform_riskman.incident_fact as t1&#xA;   inner join&#xA;   (&#xA;&#xA;  select f1.id,f1.baseid ,f2.*&#x9;,d1.portfolio_key&#xA;  from extract_riskman.IncidentsForReview  as f1&#xA;   inner join  conform_riskman.program_mapping as f2&#x9;    on f1.EmployeeSite=f2.value1&#xA;  inner join conform_riskman.portfolio_dim as d1 on d1.portfolio_name=f2.program_name and d1.current_row_indicator='Y'&#xA;  where f2.mapping_type='Portfolio'&#x9;  and f2.system='Riskman' and f2.table1='ANGCARE_IFR'&#xA;&#xA; ) as t2&#xA; on t1.id =t2.id &#xA; and t1.base_id=t2.BaseID&#xA;&#xA;-------------------------------------------------------WAY3: CustomerSite------------------------------------------------------------------------------------------------------------------------------------------------------------&#xA;   update t1&#xA;   set   t1.program_key=t2.program_key&#xA;   from   conform_riskman.incident_fact as t1&#xA;   inner join&#xA;   (&#xA;&#xA;  select f1.id,f1.baseid,f2.program_key&#xA;  from extract_riskman.IncidentsForReview  as f1&#xA;  inner join  conform_riskman.program_mapping as f2&#xA;  on f1.Incident_Location=f2.value1&#xA;  where  f2.table1='IncidentsForReview' and f2.name1='CustomerSite' and  f2.value1 is not null&#xA;&#xA; ) as t2&#xA; on t1.id =t2.id &#xA; and t1.base_id=t2.BaseID&#xA; where   t1.program_key=(select program_key from conform_riskman.program_dim where current_row_indicator='Y' and program_name ='No Program')&#xA;&#xA;  &#xA;&#xA; update k&#xA; set   k.service_stream_key=i.service_stream_key, k.portfolio_key=i.portfolio_key&#xA; from   conform_riskman.incident_fact as k&#xA; inner join&#xA;(&#xA;select &#xA; n1.incident_key,&#xA; n1.program_name,&#xA; n1.service_stream_name,&#xA; n1.portfolio_name,&#xA; dd1.service_stream_key,&#xA; dd2.portfolio_key&#xA;&#xA;&#xA;from&#xA;(&#xA;select   g2.incident_key,f2.program_name,f2.service_stream_name,f2.portfolio_name&#xA;from &#xA;(&#xA;select  f1.incident_key, g1.program_name&#xA;from conform_riskman.incident_fact as f1&#xA;inner join conform_riskman.program_dim as g1 on f1.program_key=g1.program_key and g1.current_row_indicator='Y'&#xA;) as g2&#xA;inner join &#xA;&#xA;&#xA;(&#xA;--get all org based on names&#xA;select distinct t1.program_code,t1.service_stream_code,t2.portfolio_code , d1.program_name  ,d2.service_stream_name ,d3.portfolio_name ,d1.program_key,d2.service_stream_key,d3.portfolio_key&#xA;from conform.program_temp  as t1&#xA;inner join conform.service_stream_temp as t2   on t1.service_stream_code=t2.service_stream_code&#xA;inner join conform.program_dim as d1 on t1.program_code=d1.program_code and d1.current_row_indicator='Y'&#xA;inner join conform.service_stream_dim as d2 on t1.service_stream_code=d2.service_stream_code and d1.current_row_indicator='Y'&#xA;inner join conform.portfolio_dim as d3 on t2.portfolio_code=d3.portfolio_code and d1.current_row_indicator='Y'&#xA;)  as f2 on g2.program_name=f2.program_name&#xA;) as n1&#xA;inner join conform_riskman.service_stream_dim as dd1 on dd1.service_stream_name=n1.service_stream_name and dd1.current_row_indicator='Y'&#xA;inner join conform_riskman.portfolio_dim as dd2 on dd2.portfolio_name=n1.portfolio_name and dd1.current_row_indicator='Y'&#xA;) as i &#xA;on k.incident_key=i.incident_key&#xA;&#xA;&#xA;&#xA;-------------------------------------------------------WAY4: incident_location------------------------------------------------------------------------------------------------------------------------------------------------------------&#xA;   update t1&#xA;   set   t1.program_key=t2.program_key&#xA;   from   conform_riskman.incident_fact as t1&#xA;   inner join&#xA;   (&#xA;&#xA;  select f1.id,f1.baseid,f2.program_key&#xA;  from extract_riskman.IncidentsForReview  as f1&#xA;  inner join  conform_riskman.program_mapping as f2&#xA;  on f1.Incident_Location=f2.value1&#xA;  where  f2.table1='IncidentsForReview' and f2.name1='Incident_Location' and  f2.value1 is not null&#xA;&#xA; ) as t2&#xA; on t1.id =t2.id &#xA; and t1.base_id=t2.BaseID&#xA; where   t1.program_key=(select program_key from conform_riskman.program_dim where current_row_indicator='Y' and program_name ='No Program')&#xA;&#xA;  &#xA;&#xA; update k&#xA; set   k.service_stream_key=i.service_stream_key, k.portfolio_key=i.portfolio_key&#xA; from   conform_riskman.incident_fact as k&#xA; inner join&#xA;(&#xA;select &#xA; n1.incident_key,&#xA; n1.program_name,&#xA; n1.service_stream_name,&#xA; n1.portfolio_name,&#xA; dd1.service_stream_key,&#xA; dd2.portfolio_key&#xA;&#xA;&#xA;from&#xA;(&#xA;select   g2.incident_key,f2.program_name,f2.service_stream_name,f2.portfolio_name&#xA;from &#xA;(&#xA;select  f1.incident_key, g1.program_name&#xA;from conform_riskman.incident_fact as f1&#xA;inner join conform_riskman.program_dim as g1 on f1.program_key=g1.program_key and g1.current_row_indicator='Y'&#xA;) as g2&#xA;inner join &#xA;&#xA;&#xA;(&#xA;--get all org based on names&#xA;select distinct t1.program_code,t1.service_stream_code,t2.portfolio_code , d1.program_name  ,d2.service_stream_name ,d3.portfolio_name ,d1.program_key,d2.service_stream_key,d3.portfolio_key&#xA;from conform.program_temp  as t1&#xA;inner join conform.service_stream_temp as t2   on t1.service_stream_code=t2.service_stream_code&#xA;inner join conform.program_dim as d1 on t1.program_code=d1.program_code and d1.current_row_indicator='Y'&#xA;inner join conform.service_stream_dim as d2 on t1.service_stream_code=d2.service_stream_code and d1.current_row_indicator='Y'&#xA;inner join conform.portfolio_dim as d3 on t2.portfolio_code=d3.portfolio_code and d1.current_row_indicator='Y'&#xA;)  as f2 on g2.program_name=f2.program_name&#xA;) as n1&#xA;inner join conform_riskman.service_stream_dim as dd1 on dd1.service_stream_name=n1.service_stream_name and dd1.current_row_indicator='Y'&#xA;inner join conform_riskman.portfolio_dim as dd2 on dd2.portfolio_name=n1.portfolio_name and dd1.current_row_indicator='Y'&#xA;) as i &#xA;on k.incident_key=i.incident_key&#xA;&#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{92db9ddb-46da-430b-bb39-d1d66ad49ce8}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\EST - Write Job Start info"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\Delete Existing Data" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{b75c5b6d-1a4f-48fa-96a4-070abd40f00e}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\Delete Existing Data"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\Populate new data" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident.PrecedenceConstraints[Constraint 2]"
              DTS:CreationName=""
              DTS:DTSID="{f581bd5f-4c86-4df5-a9c1-080ced77e66d}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\Populate new data"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 2"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\EST - Write Job Finish info" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{e943c396-1ee1-455a-868c-f711a3d55bba}"
              DTS:EventID="244"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{59fb28bc-993b-40c0-8ea4-ec39fd9529a2}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{4ba8c436-0982-4c1d-8d10-989822a223a9}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Execute SQL Task - Catch Error Details">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{E85ED4B0-760B-483B-A76C-D79EA17A6DAC}"
                      SQLTask:SqlStatementSource="-- insert into management.ERROR_EVENT_DETAIL_FACT table&#xA;&#xA;insert into management.ERROR_EVENT_DETAIL_FACT&#xA;SELECT &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,T2.TABLE_KEY&#xA;,T2.TABLE_KEY&#xA;,?&#xA;,' '&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;&#xA;-- insert into [management].ETL_PROCESS_FACT with 'Failed'&#xA;INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,3&#xA;,GETDATE() &#xA;,4&#xA;,'Update Fact Table'    &#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA; -- insert into management.ERROR_EVENT_FACT table&#xA;insert into management.ERROR_EVENT_FACT&#xA;SELECT &#xA;(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,convert(varchar, getdate(),21)&#xA;, 'HIGH'&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ParameterBinding
                        SQLTask:ParameterName="0"
                        SQLTask:DtsVariableName="System::ErrorDescription"
                        SQLTask:ParameterDirection="Input"
                        SQLTask:DataType="130"
                        SQLTask:ParameterSize="-1" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Sequence Container"
          DTS:DTSID="{13e76938-0a7c-4841-8f02-a9f3cbf2be22}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="SD1 INCIDENT_HISTORY_FACT">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\Delete Existing Data"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{5091da05-f855-4534-a14e-9660238e9117}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Delete Existing Data"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="--- need to change later just delete the data for yesterday&#xA;&#xA;truncate table  conform_riskman.INCIDENT_HISTORY_FACT" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\EST - Write Job Finish info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{e1dda5b4-1c9d-44af-a62c-665867754dad}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Finish info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,2&#xA;,GETDATE() ,&#xA;4,&#xA;'Finish updating FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_riskman.INCIDENT_HISTORY_FACT'&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\EST - Write Job Start info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{8f717c0c-178b-4e4b-b189-84b5473b5f5d}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Start info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,1&#xA;,GETDATE() ,&#xA;4,&#xA;'Start to update FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_riskman.INCIDENT_HISTORY_FACT'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\Populate new data"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{978eced7-c47a-41ec-894c-5732cc11410a}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Populate new data"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{5A883BE2-5337-4500-9122-FDA41FA62F37}"
                  SQLTask:SqlStatementSource="insert into    conform_riskman.INCIDENT_HISTORY_FACT   &#xA;select &#xA;isnull(ttt.employee_key,(select employee_key from conform_riskman.employee_dim&#x9;where given_name='-' and current_row_indicator='Y') ),&#xA;&#xA;f1.incident_key&#x9;  ,&#xA;isnull(ttt.employee_key,(select employee_key from conform_riskman.employee_dim&#x9;where given_name='-' and current_row_indicator='Y') ),&#xA;t1.DateEntered&#x9;&#x9; &#xA;&#xA;from    extract_riskman.IncidentsForReview&#x9; as t1&#xA;left join conform_riskman.incident_fact as f1 on t1.baseid =f1.base_id&#xA;left join&#xA;&#xA; ( &#xA; select distinct fff.id,&#xA;                 fff.employee_key&#xA; from &#xA; (&#xA;  select  distinct  g1.id, d1.employee_key&#xA;      from  extract_riskman.IncidentsForReview as g1&#xA;      inner join   conform_riskman.employee_dim as d1 &#xA;&#x9;  on  g1.username = d1.AD_UserID&#x9; &#xA;   union&#xA;      select  distinct  g1.id, d1.employee_key&#xA;      from  extract_riskman.IncidentsForReview as g1&#xA;      inner join   conform_riskman.employee_dim as d1 &#xA;&#x9;  on  g1.username = d1.user_id&#xA;   union&#xA;        select f1.id,f3.employee_key &#xA;&#x9;&#x9;from  extract_riskman.IncidentsForReview  as f1&#xA;&#x9;&#x9;inner join extract_riskman.UserProfile as f2  on f1.username =f2.username &#xA;&#x9;&#x9;inner join conform_riskman.employee_dim as f3 on f2.LDAP_Username=f3.AD_UserID&#xA; ) as fff&#xA; &#xA; ) as ttt&#xA; on t1.id=ttt.ID&#xA;&#xA;&#xA;--update manager_key&#xA;&#xA;update &#x9;tt1&#xA;set tt1.manager_key=tt2.employee_key&#xA;from conform_riskman.INCIDENT_HISTORY_FACT  as tt1&#xA;inner join&#xA;(&#xA;select&#x9;g1.*,i1.employee_key as manager_key&#xA;from &#xA;(&#xA;select t1.employee_key,t1.id_number,k1.manager_id_number &#xA;from conform_riskman.employee_dim as t1&#xA;left join &#xA;(select f1.employee_key,&#xA;       d1.id_number as employee_id_number,&#xA;       f1.manager_key &#x9;,&#xA;&#x9;   d2.id_number as manager_id_number&#xA;from conform.employee_position_fact as f1&#xA;left join conform.employee_dim as d1 on f1.employee_key=d1.employee_key &#x9;and d1.current_row_indicator='Y'&#xA;left join conform.employee_dim as d2 on f1.manager_key=d2.employee_key &#x9;and d2.current_row_indicator='Y'&#xA;where f1.primary_position_flag='P'&#xA;) as k1 on t1.id_number =k1.employee_id_number and t1.current_row_indicator='Y'&#xA;) as g1&#xA;left join conform_riskman.employee_dim as i1 on g1.manager_id_number=i1.id_number and i1.current_row_indicator='Y'&#xA;) as tt2&#xA;on tt1.employee_key=tt2.employee_key&#xA;and tt2.manager_key is not null" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{35fa78e7-4787-4420-9738-1d66446de8e9}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\EST - Write Job Start info"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\Delete Existing Data" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{c1413ff1-5d92-4050-8a0e-92c22e64f937}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\Delete Existing Data"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\Populate new data" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT.PrecedenceConstraints[Constraint 2]"
              DTS:CreationName=""
              DTS:DTSID="{b57bb629-84f8-4412-8a3c-1846daf2ca0c}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\Populate new data"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 2"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\EST - Write Job Finish info" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{0bbf4a4e-b00c-48c0-a929-7359a32654df}"
              DTS:EventID="244"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{96e447f5-0655-4fe0-936d-93f9807291f6}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{c9df87a8-7616-4658-9062-28017d2e5223}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Execute SQL Task - Catch Error Details">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{E85ED4B0-760B-483B-A76C-D79EA17A6DAC}"
                      SQLTask:SqlStatementSource="-- insert into management.ERROR_EVENT_DETAIL_FACT table&#xA;&#xA;insert into management.ERROR_EVENT_DETAIL_FACT&#xA;SELECT &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,T2.TABLE_KEY&#xA;,T2.TABLE_KEY&#xA;,?&#xA;,' '&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;&#xA;-- insert into [management].ETL_PROCESS_FACT with 'Failed'&#xA;INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,3&#xA;,GETDATE() &#xA;,4&#xA;,'Update Fact Table'    &#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA; -- insert into management.ERROR_EVENT_FACT table&#xA;insert into management.ERROR_EVENT_FACT&#xA;SELECT &#xA;(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,convert(varchar, getdate(),21)&#xA;, 'HIGH'&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ParameterBinding
                        SQLTask:ParameterName="0"
                        SQLTask:DtsVariableName="System::ErrorDescription"
                        SQLTask:ParameterDirection="Input"
                        SQLTask:DataType="130"
                        SQLTask:ParameterSize="-1" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Sequence Container - Fact Tables.PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{6961DBFC-48D9-4CAC-923C-B5D0F6B02135}"
          DTS:From="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident"
          DTS:Value="2" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Sequence Container - Fact Tables.PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{435CDCB1-18D4-42CD-AB5E-9D78E81DA38F}"
          DTS:From="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT"
          DTS:Value="2" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Sequence Container - Fact Tables.PrecedenceConstraints[Constraint 2]"
          DTS:CreationName=""
          DTS:DTSID="{F643E514-FC19-4DDB-81C6-E85EFB81F73B}"
          DTS:From="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 2"
          DTS:To="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT"
          DTS:Value="2" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Sequence Container - Fact Tables.PrecedenceConstraints[Constraint 3]"
          DTS:CreationName=""
          DTS:DTSID="{BE2B1C16-B234-4186-9113-7C455AA7B5C5}"
          DTS:From="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 3"
          DTS:To="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT"
          DTS:Value="2" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{6558A388-A610-4926-AE15-BDFFEAB36553}"
      DTS:EventID="1701257339"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{44549B00-7D16-4BD0-B96F-4430097C777C}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables />
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="64" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\Delete Existing Data"
          TopLeft="31.75,91" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\EST - Write Job Finish info"
          TopLeft="32.75,256" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\EST - Write Job Start info"
          TopLeft="30.75,15" />
        <NodeLayout
          Size="269,42"
          Id="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT\Populate new data"
          TopLeft="29.75,156" />
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT.PrecedenceConstraints[Constraint]"
          TopLeft="166.75,57">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34"
              Start="0,0"
              End="0,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT.PrecedenceConstraints[Constraint 1]"
          TopLeft="165.75,133">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,23"
              Start="0,0"
              End="0,15.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT.PrecedenceConstraints[Constraint 2]"
          TopLeft="166.25,198">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,58"
              Start="0,0"
              End="0,50.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,50.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="382,329"
          Size="382,372"
          Id="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT"
          TopLeft="19.0000000000002,1301.5" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\Delete Existing Data"
          TopLeft="31.75,91" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\EST - Write Job Finish info"
          TopLeft="32.75,256" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\EST - Write Job Start info"
          TopLeft="30.75,15" />
        <NodeLayout
          Size="269,42"
          Id="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT\Populate new data"
          TopLeft="29.75,156" />
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT.PrecedenceConstraints[Constraint]"
          TopLeft="166.75,57">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34"
              Start="0,0"
              End="0,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT.PrecedenceConstraints[Constraint 1]"
          TopLeft="165.75,133">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,23"
              Start="0,0"
              End="0,15.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT.PrecedenceConstraints[Constraint 2]"
          TopLeft="166.25,198">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,58"
              Start="0,0"
              End="0,50.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,50.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="382,329"
          Size="382,372"
          Id="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT"
          TopLeft="19.0000000000001,869.5" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\Delete Existing Data"
          TopLeft="31.75,91" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\EST - Write Job Finish info"
          TopLeft="32.75,256" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\EST - Write Job Start info"
          TopLeft="30.75,15" />
        <NodeLayout
          Size="269,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables\Populate new data"
          TopLeft="29.75,156" />
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables.PrecedenceConstraints[Constraint]"
          TopLeft="166.75,57">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34"
              Start="0,0"
              End="0,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables.PrecedenceConstraints[Constraint 1]"
          TopLeft="165.75,133">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,23"
              Start="0,0"
              End="0,15.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables.PrecedenceConstraints[Constraint 2]"
          TopLeft="166.25,198">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,58"
              Start="0,0"
              End="0,50.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,50.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="409,329"
          Size="409,372"
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables"
          TopLeft="5.50000000000006,5.5" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\Delete Existing Data"
          TopLeft="31.75,91" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\EST - Write Job Finish info"
          TopLeft="32.75,256" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\EST - Write Job Start info"
          TopLeft="30.75,15" />
        <NodeLayout
          Size="269,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident\Populate new data"
          TopLeft="29.75,156" />
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident.PrecedenceConstraints[Constraint]"
          TopLeft="166.75,57">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34"
              Start="0,0"
              End="0,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident.PrecedenceConstraints[Constraint 1]"
          TopLeft="165.75,133">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,23"
              Start="0,0"
              End="0,15.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident.PrecedenceConstraints[Constraint 2]"
          TopLeft="166.25,198">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,58"
              Start="0,0"
              End="0,50.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,50.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="409,329"
          Size="409,372"
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident"
          TopLeft="5.50000000000009,437.5" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\Delete Existing Data"
          TopLeft="31.75,91" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\EST - Write Job Finish info"
          TopLeft="32.75,256" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\EST - Write Job Start info"
          TopLeft="30.75,15" />
        <NodeLayout
          Size="269,42"
          Id="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT\Populate new data"
          TopLeft="29.75,156" />
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT.PrecedenceConstraints[Constraint]"
          TopLeft="166.75,57">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34"
              Start="0,0"
              End="0,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT.PrecedenceConstraints[Constraint 1]"
          TopLeft="165.75,133">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,23"
              Start="0,0"
              End="0,15.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT.PrecedenceConstraints[Constraint 2]"
          TopLeft="166.25,198">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,58"
              Start="0,0"
              End="0,50.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,50.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="409,329"
          Size="409,372"
          Id="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT"
          TopLeft="5.50000000000026,1733.5" />
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables.PrecedenceConstraints[Constraint]"
          TopLeft="210,377.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-25.304453125,20.4453125,50.60890625,11.609375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables.PrecedenceConstraints[Constraint 1]"
          TopLeft="210,809.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-25.304453125,20.4453125,50.60890625,11.609375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables.PrecedenceConstraints[Constraint 2]"
          TopLeft="210,1241.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-25.304453125,20.4453125,50.60890625,11.609375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables.PrecedenceConstraints[Constraint 3]"
          TopLeft="210,1673.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-25.304453125,20.4453125,50.60890625,11.609375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="420,2161"
          Size="420,2204"
          Id="Package\Sequence Container - Fact Tables"
          TopLeft="34.5,1" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="264,42"
          Id="Package\Sequence Container - Fact Tables\INCIDENT_ACTION_FACT.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
          TopLeft="448,222" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="264,42"
          Id="Package\Sequence Container - Fact Tables\INCIDENT_TYPE_FACT.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
          TopLeft="448,222" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="264,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- keep all records and with bridge tables.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
          TopLeft="448,222" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="264,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - INCIDENT_FACT -- Keep one record for one incident.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
          TopLeft="448,222" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="264,42"
          Id="Package\Sequence Container - Fact Tables\SD1 INCIDENT_HISTORY_FACT.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
          TopLeft="448,222" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>