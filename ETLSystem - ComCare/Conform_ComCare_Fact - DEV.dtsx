<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="8/23/2016 2:19:29 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="W7PC01XQ1T"
  DTS:CreatorName="ANGLICARE-SA\jshen"
  DTS:DTSID="{76858F61-5624-4EA2-8253-23474F37ABF2}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="13.0.2164.0"
  DTS:LocaleID="3081"
  DTS:ObjectName="Conform_ComCare_Fact - DEV"
  DTS:PackageType="5"
  DTS:ProtectionLevel="0"
  DTS:VersionBuild="566"
  DTS:VersionGUID="{22135B35-EE9E-439B-96E9-DDC4A21F9214}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[devsql-1\whouse.DWHB.asadwh]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{036387CF-70D3-4FDA-8C0E-A48875FBFE17}"
      DTS:ObjectName="devsql-1\whouse.DWHB.asadwh">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=devsql-1\whouse;Initial Catalog=DWHB;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{B976D153-BA01-4551-B084-D332849AF2F7}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="anniversary_date_key">
      <DTS:VariableValue
        DTS:DataType="3">9999999</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{B41DA2B8-DCBB-4062-90E2-8EBA96387B1C}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="change_reason_code_new">
      <DTS:VariableValue
        DTS:DataType="8">N</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D2C9B388-73BE-4718-BD5F-14B3678A15E0}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="change_reason_code_update">
      <DTS:VariableValue
        DTS:DataType="8">U</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3E745257-797B-472C-8EA4-79277BF1CEB8}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="change_reason_description_new">
      <DTS:VariableValue
        DTS:DataType="8">NEW</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{0A2DCEE1-1E55-413E-AD16-F19CC760F70E}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="change_reason_description_update">
      <DTS:VariableValue
        DTS:DataType="8">UPDATE</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{A467987D-38D9-4265-AAE1-0AD611A57032}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="current_row_indicator">
      <DTS:VariableValue
        DTS:DataType="8">Y</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{02A753D2-F72D-42F9-AA94-83552A6834B1}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="GETDATE()"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="etl_start_date">
      <DTS:VariableValue
        DTS:DataType="7">11/30/2017 3:22:12 PM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E14A995D-60F8-4D35-BE07-2F89BDA2F7FE}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="manager_pos_key">
      <DTS:VariableValue
        DTS:DataType="3">1694</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{6B716E3F-36E5-458B-9932-5DDB0969D721}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="manger_key">
      <DTS:VariableValue
        DTS:DataType="3">1780</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{EA89E410-F0A8-423C-9902-B42866112055}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="new_position_flag">
      <DTS:VariableValue
        DTS:DataType="8">Y</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{7BCBE67F-7828-4345-B6C3-EA47E2A7A4F7}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="position_vacant_date_key">
      <DTS:VariableValue
        DTS:DataType="3">9999999</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F17DA3D4-6A20-4261-B1CA-B3D1BD61116A}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="GETDATE()"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="row_effective_date">
      <DTS:VariableValue
        DTS:DataType="7">11/30/2017 3:22:12 PM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CFC01FDD-4FA0-4D37-A32C-22245363C8C1}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="GETDATE()"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="row_expiration_date">
      <DTS:VariableValue
        DTS:DataType="7">11/30/2017 3:22:12 PM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{07734777-3A57-4DE1-89A5-84B66DAB6DD5}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="survery_completed">
      <DTS:VariableValue
        DTS:DataType="8">NO</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Sequence Container - Fact Tables"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Sequence Container"
      DTS:DTSID="{5FB1485D-C401-4D81-AFDE-286963429D2E}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Sequence Container - Fact Tables">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Sequence Container"
          DTS:DTSID="{23D278FC-381E-47DD-A281-F52C5DACD511}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="SD1 - CUSTOMER_TRANSACTION_FACT">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\CIM historic transaction - just import once"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{07a8ef42-b0d6-49d7-9f43-a3eafc20aed8}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="CIM historic transaction - just import once"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{036387CF-70D3-4FDA-8C0E-A48875FBFE17}"
                  SQLTask:SqlStatementSource="--- Import once and wont change later&#xA;---CHECKING and TESTING&#xA;&#xA;&#xA;&#xA;insert into conform_comcare.customer_transactions_fact&#xA;   select&#xA;        d1.customer_key, &#x9;&#xA;         isnull(d2.date_key, '9999999') ,&#xA;&#x9;&#x9;(select transaction_type_key&#xA;&#x9;&#x9; from conform_comcare.transaction_type_dim &#xA;&#x9;&#x9; where current_row_indicator='Y'&#xA;&#x9;&#x9; and transaction_source=   (   case&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCLEVEL1'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Base Subsidy'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCSUBDEM'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Dementia and Cognition and Vet'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCLEVEL4'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Base Subsidy'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCSUBOTHE'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Dementia and Cognition and Vet'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCSUBVET'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Dementia and Cognition and Vet'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCCLIENT'&#x9;and f1.portion=&#x9;'Client'&#x9;then&#x9;'Payments Received'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCSELFUND'&#x9;and f1.portion=&#x9;'Client'&#x9;then&#x9;'Payments Received'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCITFS'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Base Subsidy'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCLEVEL3'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Base Subsidy'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCLEVEL2'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Base Subsidy'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCITF'&#x9;and f1.portion=&#x9;'Client'&#x9;then&#x9;'Payments Received'&#x9; &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;end&#x9; &#x9;&#x9; &#xA;&#x9;&#x9;                        ) &#x9;&#x9; &#xA;&#x9;&#x9; )&#x9; as transaction_type_Key ,&#xA;&#x9;&#x9; case  f1.description&#xA;&#x9;&#x9;&#x9;   when 'CDC East' then '8'&#xA;&#x9;&#x9;&#x9;   when 'CDC North' then '9'&#xA;&#x9;&#x9;&#x9;   when 'CDC South' then '11'&#xA;&#x9;&#x9;&#x9;   when 'CDCWest' then '12'&#xA;&#x9;&#x9;&#x9;   when 'CDC Gawler' then '10'&#xA;&#x9;&#x9;&#x9;   else    '10'&#xA;&#x9;&#x9;&#x9;   end,&#x9;       &#xA;       (select responsible_party_key from  CONFORM_comcare.responsible_party_dim&#x9;  where   given_name='-' and current_row_indicator='Y' ),  --set default key&#x9;&#xA;&#x9;&#xA;              case&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCLEVEL1'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;- f1.amount&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCSUBDEM'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;  f1.amount&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCLEVEL4'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9; - f1.amount&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCSUBOTHE'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;  f1.amount&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCSUBVET'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;  f1.amount&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCCLIENT'&#x9;and f1.portion=&#x9;'Client'&#x9;then&#x9;f1.amount&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCSELFUND'&#x9;and f1.portion=&#x9;'Client'&#x9;then&#x9;f1.amount&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCITFS'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;-  f1.amount&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCLEVEL3'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;-  f1.amount&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCLEVEL2'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;-  f1.amount&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCITF'&#x9;and f1.portion=&#x9;'Client'&#x9;then&#x9;f1.amount &#xA;&#x9;&#x9;&#x9;end ,&#xA;&#xA;      0.0 ,&#xA;&#x9;  case&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCLEVEL1'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Base Subsidy'&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCSUBDEM'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Dementia and Cognition and Vet'&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCLEVEL4'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Base Subsidy'&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCSUBOTHE'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Dementia and Cognition and Vet'&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCSUBVET'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Dementia and Cognition and Vet'&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCCLIENT'&#x9;and f1.portion=&#x9;'Client'&#x9;then&#x9;'Payments Received'&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCSELFUND'&#x9;and f1.portion=&#x9;'Client'&#x9;then&#x9;'Payments Received'&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCITFS'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Base Subsidy'&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCLEVEL3'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Base Subsidy'&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCLEVEL2'&#x9;and f1.portion=&#x9;'Commonwealth'&#x9;then&#x9;'Base Subsidy'&#xA;&#x9;&#x9;&#x9;when f1.charge_code=&#x9;'CDCITF'&#x9;and f1.portion=&#x9;'Client'&#x9;then&#x9;'Payments Received'&#x9; &#xA;&#x9;&#x9;&#x9;end as transaction_source,&#xA;&#x9;&#x9;&#x9;  f1.narration,&#xA;&#x9;  'charge_code: '+f1.charge_code+', portion: '+f1.portion,&#xA;&#x9;  'CIM'&#x9;&#x9;&#x9;&#x9;       &#xA;&#xA;from extract_cim.cim_txn_data as f1&#xA;   inner join conform_comcare.customer_dim as d1 on f1.id_number=d1.cim_id_number and d1.current_row_indicator='Y'  &#x9;and len(d1.cim_id_number)&lt;&gt;0&#xA;   inner join conform_comcare.date_dim as d2 on convert(date,f1.transaction_date)=convert(date,d2.full_date)&#xA;&#xA;&#xA;&#xA;&#xA;--admin / coordation &#xA;&#xA; insert into conform_comcare.customer_transactions_fact&#xA;   select&#xA;        d1.customer_key, &#x9;&#xA;         isnull(d2.date_key, '9999999') ,&#xA;&#x9;&#x9;(select transaction_type_key&#xA;&#x9;&#x9; from conform_comcare.transaction_type_dim &#xA;&#x9;&#x9; where current_row_indicator='Y'&#xA;&#x9;&#x9; and transaction_source=   (   case&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code like &#x9;'CDCADMIN%'&#x9;&#x9;then&#x9;'Administration Fee'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code like    'CDCCOOR%'&#x9;then&#x9;'Coordination Fee - Full Suppor'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else 'Support Services'&#x9; &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;end&#x9; &#x9;&#x9; &#xA;&#x9;&#x9;                        ) &#x9;&#x9; &#xA;&#x9;&#x9; )&#x9; as transaction_type_Key ,&#xA;&#x9;&#x9; case  f1.description&#xA;&#x9;&#x9;&#x9;   when 'CDC East' then '8'&#xA;&#x9;&#x9;&#x9;   when 'CDC North' then '9'&#xA;&#x9;&#x9;&#x9;   when 'CDC South' then '11'&#xA;&#x9;&#x9;&#x9;   when 'CDCWest' then '12'&#xA;&#x9;&#x9;&#x9;   when 'CDC Gawler' then '10'&#xA;&#x9;&#x9;&#x9;   else    '10'&#xA;&#x9;&#x9;&#x9;   end,&#x9;       &#xA;       (select responsible_party_key from  CONFORM_comcare.responsible_party_dim&#x9;  where   given_name='-' and current_row_indicator='Y' ),  --set default key&#x9;&#xA;&#x9;&#xA;            case&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code like &#x9;'CDCADMIN%'&#x9;&#x9;then&#x9;-f1.amount&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code like    'CDCCOOR%'&#x9;then&#x9;-f1.amount&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else -f1.amount &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;end&#x9;,&#xA;&#xA;      0.0 ,&#xA;&#x9;   case&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code like &#x9;'CDCADMIN%'&#x9;&#x9;then&#x9;'Administration Fee'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when f1.charge_code like    'CDCCOOR%'&#x9;then&#x9;'Coordination Fee - Full Suppor'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else 'Support Services'&#x9; &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;end&#x9; &#x9;,&#xA;&#x9;&#x9;&#x9;  f1.narration,&#xA;&#x9;  'charge_code: '+f1.charge_code,&#xA;&#x9;  'CIM'&#x9;&#x9;&#x9;&#x9;       &#xA;&#xA;from extract_cim.cim_data_part2 as f1&#xA;   inner join conform_comcare.customer_dim as d1 on f1.id_number=d1.cim_id_number and d1.current_row_indicator='Y'  &#x9;and len(d1.cim_id_number)&lt;&gt;0&#xA;   inner join conform_comcare.date_dim as d2 on convert(date,f1.transaction_date)=convert(date,d2.full_date)&#xA;   where ( f1.charge_code like 'CDCADMIN%' or  f1.charge_code like  'CDCCOOR%' );&#xA;&#xA;&#xA;--service charges: just pick up one line per month from import data.&#xA;&#xA;&#xA; insert into conform_comcare.customer_transactions_fact&#xA;   select&#xA;        d1.customer_key, &#x9;&#xA;         isnull(d2.date_key, '9999999') ,&#xA;&#x9;&#x9;(select transaction_type_key&#xA;&#x9;&#x9; from conform_comcare.transaction_type_dim &#xA;&#x9;&#x9; where current_row_indicator='Y'&#xA;&#x9;&#x9; and transaction_source=    'Support Services'                 &#x9;&#x9; &#xA;&#x9;&#x9; )&#x9; as transaction_type_Key ,&#xA;&#x9;&#x9; case  f1.description&#xA;&#x9;&#x9;&#x9;   when 'CDC East' then '8'&#xA;&#x9;&#x9;&#x9;   when 'CDC North' then '9'&#xA;&#x9;&#x9;&#x9;   when 'CDC South' then '11'&#xA;&#x9;&#x9;&#x9;   when 'CDCWest' then '12'&#xA;&#x9;&#x9;&#x9;   when 'CDC Gawler' then '10'&#xA;&#x9;&#x9;&#x9;   else    '10'&#xA;&#x9;&#x9;&#x9;   end,&#x9;       &#xA;       (select responsible_party_key from  CONFORM_comcare.responsible_party_dim&#x9;  where   given_name='-' and current_row_indicator='Y' ),  --set default key&#x9;&#xA;&#x9;&#xA;         -f1.total_amount, &#xA;&#xA;      0.0 ,&#xA;&#x9;   'Support Services',&#xA;&#x9;&#x9;&#x9;  f1.narration,&#xA;&#x9;          f1.narration,&#xA;&#x9;  'CIM'&#x9;&#x9;&#x9;&#x9;       &#xA;&#xA;from &#xA;&#x9; (&#xA;&#x9;&#x9;select distinct  id_number,&#xA;&#x9;&#x9;description,&#xA;        dateadd(dd,-30,transaction_date) as transaction_date,&#xA;&#x9;    narration,&#xA;&#x9;    total_amount&#xA;&#x9;    from extract_cim.cim_data_part2  &#xA;       where ( charge_code not like 'CDCADMIN%' and  charge_code not like  'CDCCOOR%' )&#xA;&#xA;&#x9; )&#xA;&#xA; as f1&#xA;   inner join conform_comcare.customer_dim as d1 on f1.id_number=d1.cim_id_number and d1.current_row_indicator='Y'  &#x9;and len(d1.cim_id_number)&lt;&gt;0&#xA;   inner join conform_comcare.date_dim as d2 on convert(date,f1.transaction_date)=convert(date,d2.full_date)&#xA;&#xA;&#xA;--delete early date&#xA;delete from  conform_comcare.customer_transactions_fact&#xA;where source_system='CIM'&#xA;and transaction_source='Support Services'&#xA;and date_key in (select date_key from conform.date_dim where convert(date,full_date) &lt; convert(date,'2015-07-01 00:00:00.000'));&#xA;&#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\ComCare FC_Transaction"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{3A50903C-6562-443B-9577-9D92601F8206}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="ComCare FC_Transaction"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{036387CF-70D3-4FDA-8C0E-A48875FBFE17}"
                  SQLTask:SqlStatementSource="--pre-proceess to change transaction_source Financial Hardship (Billing Li to Financial Hardship Financial Hardship (Billing Li &#xA;--added by JS at 1/11/2017&#xA;&#xA;update extract_comcare.FC_Transaction  &#xA;&#x9;set Transaction_Source='Financial Hardship'&#xA;&#x9;where Transaction_Source='Financial Hardship (Billing Li'&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;--get comcare transaction except EXPENSE&#xA;insert into conform_comcare.customer_transactions_fact&#xA;  select &#xA;  &#x9;       d1.customer_key,&#x9; &#xA;&#x9;       isnull(d2.date_key, '9999999') ,&#xA;&#x9;&#x9;   isnull(d4.transaction_type_key, (select transaction_type_key from conform_comcare.transaction_type_dim where transaction_type_natural_key=999999 and current_row_indicator='Y' ) )&#x9;,&#xA;&#x9;&#x9;   d3.program_key,&#x9; &#xA;&#x9;                    (select responsible_party_key from  CONFORM_comcare.responsible_party_dim&#x9;  where   given_name='-' and current_row_indicator='Y' ),&#x9;  --set default key&#x9;&#x9;&#x9;&#x9;   &#xA;&#x9;&#x9;   t1.actual_amount,&#xA;&#x9;&#x9;   0.00,&#x9;&#x9;&#x9;&#x9;&#x9;   &#xA;&#x9;                   ----replace transaction_source  'New Income Tested'  to 'Income Tested'&#xA;                                   case t1.Transaction_Source&#xA;&#x9;&#x9;&#x9;when 'New Income Tested' then 'Income Tested'&#xA;&#x9;&#x9;&#x9;else t1.Transaction_Source&#xA;&#x9;&#x9;&#x9;end&#x9;,   &#xA;&#x9;&#x9;    (case t1.Transaction_Source&#xA;&#x9;&#x9;&#x9;when 'New Income Tested' then 'Income Tested'&#xA;&#x9;&#x9;&#x9;else t1.Transaction_Source&#xA;&#x9;&#x9;&#x9;end)+' '+convert(varchar(10),t1.Activity_Date,103 ) ,&#xA;                                 t1.comments,&#xA;                                'Comcare'&#xA;                                  &#xA;   from  extract_comcare.FC_Transaction as t1&#xA;   inner join  extract_comcare.FC_Account  as t2 on t1.FC_Account_ID=t2.FC_Account_ID&#xA;   inner join  extract_comcare.FC_Client_Contract  as t3 on t2.Client_Contract_ID=t3.Client_Contract_ID &#xA;   inner join conform_comcare.customer_dim as d1 on t3.Client_ID=d1.client_id and d1.current_row_indicator='Y'&#xA;--- use client.FC_Account_ID to get right transaction data which need to be extraced.&#xA;  inner join &#xA;(&#x9;&#x9;  SELECT FCA.Client_Contract_ID,FCCC.Client_ID,FCCC.Program_Level_ID,FCA.FC_Account_ID&#xA;&#x9;&#x9;&#x9;FROM extract_comcare.FC_Account FCA &#xA;&#x9;&#x9;&#x9;&#x9;JOIN extract_comcare.FC_Client_Contract FCCC&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ON FCA.Client_Contract_ID=FCCC.Client_Contract_ID&#xA;&#x9;&#x9;&#x9;&#x9;JOIN extract_comcare.FC_Account_Type FCAT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ON FCA.FC_Account_Type_ID = FCAT.FC_Account_Type_ID&#xA;&#x9;&#x9;&#x9;WHERE FCCC.Funder_Contract_ID in  (3,4,5,6,7)&#xA;&#x9;&#x9;&#x9;&#x9;--AND ISNULL(FCCC.End_Date_Of_Claim ,'31 Dec 9999') &gt; Dateadd(mm,-12,GETdate() )&#xA;&#x9;&#x9;&#x9;&#x9;AND FCAT.Print_On_Statement = 1&#xA;&#x9;&#x9;&#x9;&#x9;AND FCAT.IS_Contigency_Account = 0&#x9;&#x9;&#xA;) as facount on t3.client_id= facount.client_id and t1.FC_Account_ID=facount.FC_Account_ID&#xA;   left join conform_comcare.date_dim as d2 on convert(date,t1.Activity_Date)=convert(date,d2.full_date)&#xA;   left join conform_comcare.program_dim as d3 on t3.Program_ID=d3.program_id_cc and d3.current_row_indicator='Y'&#xA;   left join conform_comcare.transaction_type_dim as d4 on t1.FC_Transaction_Type_ID=d4.transaction_type_natural_key and t1.Transaction_Source=d4.transaction_source&#x9;   and d4.current_row_indicator='Y'&#xA;   where  t3.Program_ID in (3,4,5,6,7)&#xA;   and t1.FC_Transaction_Type_ID&lt;&gt;4&#xA;&#xA;&#xA;--get EXPENSE becasue comments are different&#xA;insert into conform_comcare.customer_transactions_fact&#xA;  select &#xA;  &#x9;       d1.customer_key,&#x9; &#xA;&#x9;       isnull(d2.date_key, '9999999') ,&#xA;&#x9;&#x9;   isnull(d4.transaction_type_key, (select transaction_type_key from conform_comcare.transaction_type_dim where transaction_type_natural_key=999999 and current_row_indicator='Y' ) )&#x9;,&#xA;&#x9;&#x9;   d3.program_key,&#x9; &#x9;&#xA;                                   (select responsible_party_key from  CONFORM_comcare.responsible_party_dim&#x9;  where   given_name='-' and current_row_indicator='Y' ), &#x9;   --set default key&#x9;&#x9;&#xA;&#x9;&#x9;   t1.actual_amount,&#xA;&#x9;&#x9;   0.00,&#x9;&#x9;&#x9;&#x9;&#x9;   &#xA;&#x9;&#x9;   t1.comments,&#x9;  &#x9;&#x9;   &#xA;&#x9;&#x9;   t1.Comments,&#xA;                                   t1.comments,&#xA;                                  'Comcare'&#xA;   from  extract_comcare.FC_Transaction as t1&#xA;    inner join  extract_comcare.FC_Account  as t2 on t1.FC_Account_ID=t2.FC_Account_ID&#xA;    inner join  extract_comcare.FC_Client_Contract  as t3 on t2.Client_Contract_ID=t3.Client_Contract_ID &#xA;--- use client.FC_Account_ID to get right transaction data which need to be extraced.&#xA;    inner join &#xA;       (    SELECT FCA.Client_Contract_ID,FCCC.Client_ID,FCCC.Program_Level_ID,FCA.FC_Account_ID&#xA;&#x9;&#x9;&#x9;FROM extract_comcare.FC_Account FCA &#xA;&#x9;&#x9;&#x9;&#x9;JOIN extract_comcare.FC_Client_Contract FCCC&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ON FCA.Client_Contract_ID=FCCC.Client_Contract_ID&#xA;&#x9;&#x9;&#x9;&#x9;JOIN extract_comcare.FC_Account_Type FCAT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ON FCA.FC_Account_Type_ID = FCAT.FC_Account_Type_ID&#xA;&#x9;&#x9;&#x9;WHERE FCCC.Funder_Contract_ID in  (3,4,5,6,7)&#xA;&#x9;&#x9;&#x9;&#x9;--AND ISNULL(FCCC.End_Date_Of_Claim ,'31 Dec 9999') &gt; Dateadd(mm,-12,GETdate() )&#xA;&#x9;&#x9;&#x9;&#x9;AND FCAT.Print_On_Statement = 1&#xA;&#x9;&#x9;&#x9;&#x9;AND FCAT.IS_Contigency_Account = 0&#x9;&#x9;&#xA;    ) as facount on t3.client_id= facount.client_id and t1.FC_Account_ID=facount.FC_Account_ID&#xA;   inner join conform_comcare.customer_dim as d1 on t3.Client_ID=d1.client_id and d1.current_row_indicator='Y'&#xA;   left join conform_comcare.date_dim as d2 on convert(date,t1.Activity_Date)=convert(date,d2.full_date)&#xA;   left join conform_comcare.program_dim as d3 on t3.Program_ID=d3.program_id_cc and d3.current_row_indicator='Y'&#xA;   left join conform_comcare.transaction_type_dim as d4 on t1.FC_Transaction_Type_ID=d4.transaction_type_natural_key and t1.Transaction_Source=d4.transaction_source&#x9;   and d4.current_row_indicator='Y'&#xA;   where  t3.Program_ID in (3,4,5,6,7)&#xA;   and t1.FC_Transaction_Type_ID=4&#xA;&#xA;&#xA;  &#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\Delete Existing Data"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{F16460E0-8512-42CA-914B-1D7C6E3788DA}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Delete Existing Data"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{036387CF-70D3-4FDA-8C0E-A48875FBFE17}"
                  SQLTask:SqlStatementSource="--- need to change later just delete the data for yesterday&#xA;truncate table conform_comcare.customer_transactions_fact" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\EST - Write Job Finish info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{BB7916B2-0FEE-4167-913E-BA71586B987C}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Finish info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{036387CF-70D3-4FDA-8C0E-A48875FBFE17}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,2&#xA;,GETDATE() ,&#xA;4,&#xA;'Finish updating FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_comcare.customer_transactions_fact'&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\EST - Write Job Start info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{DC19B0B3-4127-400F-9A2A-C4EB4D52E665}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Start info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{036387CF-70D3-4FDA-8C0E-A48875FBFE17}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,1&#xA;,GETDATE() ,&#xA;4,&#xA;'Start to update FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_comcare.customer_transactions_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\T1 Payment"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{8a91b497-8378-424b-99b9-0b2e517d207a}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="T1 Payment"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{036387CF-70D3-4FDA-8C0E-A48875FBFE17}"
                  SQLTask:SqlStatementSource="use dwhb &#xA;&#xA;--get T1 paygement transaction&#xA;--get data for client pay by themself&#xA;--new ComCare Package Receipt: PKGRECCC&#xA;-----------------------------------------------------------------------------------------BIG CHANGES-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xA;--27/06/2017: T1 history payment will use exported file which has key word: Receipt - Thank you (Invoice No:XX) in Narr2. The data structure is different with extract.GLF_LDG_ACC_TRANS table, so we need to  populate data from import table  extract_comcare.T1_export_receipts  into extract.GLF_LDG_ACC_TRANS &#xA;--also change filter for doc_type just include  new format for future PKGRECCC,BPRECCCP,RECCCNP,DDRECCCP&#xA;&#xA;&#xA;&#xA;&#xA;--STEP1: populate export receipt transaction into extract.GLF_LDG_ACC_TRANS  added at 27/06/2017&#xA;insert into conform_comcare.customer_transactions_fact&#xA;     select&#xA;&#x9;       d1.customer_key,  &#xA;&#x9;       isnull(d2.date_key, '9999999') ,&#xA;&#x9;&#x9;   (select transaction_type_key from conform_comcare.transaction_type_dim where transaction_type_description='Payments Received'),&#xA;                               case  f1.Program_Category&#xA;&#x9;&#x9;   when 'HCPEAST' then '8'&#xA;&#x9;&#x9;   when 'HCPNORTH' then '9'&#xA;&#x9;&#x9;   when 'HCPSOUTH' then '11'&#xA;&#x9;&#x9;   when 'HCPWEST' then '12'&#xA;&#x9;&#x9;   when 'HCPYLNB' then '10'&#xA;&#x9;&#x9;   end,&#xA;&#xA;                                  (select responsible_party_key from  CONFORM_comcare.responsible_party_dim&#x9;  where   given_name='-' and current_row_indicator='Y' ),  --set default key&#x9;&#x9;&#xA;&#x9;&#x9;-- convert(decimal(10,2),  f1.Amount_1)*(-1),&#xA;&#x9;&#x9; convert(decimal(10,2),left(f1.Amount_1,10)) *(-1),&#xA;&#x9;&#x9;&#x9;0.0,&#xA;                                Narr2 + '  '+ convert(varchar(10),f1.Date_1,103),&#xA;&#x9;&#x9;Narr2 + '  '+ convert(varchar(10),f1.Date_1,103),&#xA;                                Narr2 + '  '+ convert(varchar(10),f1.Date_1,103),&#xA;                                'T1'&#xA;&#xA;from extract_comcare.T1_export_receipts  as f1&#xA;   inner join conform_comcare.customer_dim as d1 on f1.client_component=d1.client_id and d1.current_row_indicator='Y'&#xA;    left join conform_comcare.date_dim as d2 on convert(date,f1.Date_1,103)=convert(date,d2.full_date)&#xA;where narr2 like 'Receipt - Thank you (Invoice No%'&#xA;and f1.Program_Category like 'HCP%'&#xA;&#xA;&#xA;&#xA;---STEP2: populate export receipt transaction where are paid by others  into extract.GLF_LDG_ACC_TRANS  added at 27/06/2017&#xA;&#xA;&#xA;&#xA;insert into conform_comcare.customer_transactions_fact&#xA;  select&#xA;&#x9;       d3.customer_key  ,  &#xA;&#x9;       isnull(d2.date_key, '9999999') ,&#xA;&#x9;&#x9;   (select transaction_type_key from conform_comcare.transaction_type_dim where transaction_type_description='Payments Received'),&#xA;                                    case  f1.Program_Category&#xA;&#x9;&#x9;   when 'HCPEAST' then '8'&#xA;&#x9;&#x9;   when 'HCPNORTH' then '9'&#xA;&#x9;&#x9;   when 'HCPSOUTH' then '11'&#xA;&#x9;&#x9;   when 'HCPWEST' then '12'&#xA;&#x9;&#x9;   when 'HCPYLNB' then '10'&#xA;&#x9;&#x9;   end,&#xA;&#xA;                                  (select responsible_party_key from  CONFORM_comcare.responsible_party_dim&#x9;  where   given_name='-' and current_row_indicator='Y' ),  --set default key&#x9;&#x9;&#xA;&#x9;&#x9;-- convert(decimal(10,2),  f1.Amount_1)*(-1),&#xA;&#x9;&#x9; convert(decimal(10,2),left(f1.Amount_1,10)) *(-1),&#xA;&#x9;&#x9;&#x9;0.0,&#xA;                                Narr2 + '  '+ convert(varchar(10),f1.Date_1,103),&#xA;&#x9;&#x9;Narr2 + '  '+ convert(varchar(10),f1.Date_1,103),&#xA;                                Narr2 + '  '+ convert(varchar(10),f1.Date_1,103),&#xA;                                'T1'&#xA;&#xA;from extract_comcare.T1_export_receipts  as f1&#xA;    left join conform_comcare.date_dim as d2 on convert(date,f1.Date_1,103)=convert(date,d2.full_date)&#xA;&#xA;&#x9;inner join &#xA;   -- get comcare bill to relationship&#xA;&#x9;   (&#xA;&#x9;   &#x9;  select t1.client_cb_id,t1.client_id,t1.billing_start_date,t1.billing_end_date&#x9;,&#xA;          t2.Client_Contract_Billed_To_ID,t2.client_cb_id as client_cb_id2,t2.Effective_From_Date,t2.Effective_To_Date ,&#xA;&#x9;    &#x9;t3.Client_Contract_Billed_To_ID as Client_Contract_Billed_To_ID2,t3.person_id as debtor_id,t3.Split_Percentage&#xA;           from  extract_comcare.FB_Client_Contract_Billing as t1&#x9;&#x9;&#xA;            inner join  extract_comcare.FB_Client_Contract_Billed_To as t2   on t1.Client_CB_ID=t2.Client_CB_ID&#xA;            inner join  extract_comcare.FB_Client_CB_Split as t3 on &#x9;t3.Client_Contract_Billed_To_ID = t2.Client_Contract_Billed_To_ID&#xA;            where t1.&#x9;Funder_Contract_ID  in (3,4,5,6,7)&#xA;&#x9;&#x9;&#x9;and t1.client_id &lt;&gt;t3.Person_ID&#xA;&#x9;   &#xA;&#x9;   &#xA;&#x9;   )&#x9; as ff on  f1.client_component=ff.debtor_id&#xA;&#xA;&#x9;   inner join conform_comcare.customer_dim as d3 on ff.Client_ID=d3.client_id and d3.current_row_indicator='Y'&#xA;where narr2 like 'Receipt - Thank you (Invoice No%'&#xA;and f1.Program_Category like 'HCP%'&#xA;&#xA;&#xA;&#xA;&#xA;---STEP3: populate data for new formats for future&#xA;insert into conform_comcare.customer_transactions_fact&#xA;     select&#xA;&#x9;       d1.customer_key,  &#xA;&#x9;       isnull(d2.date_key, '9999999') ,&#xA;&#x9;&#x9;   (select transaction_type_key from conform_comcare.transaction_type_dim where transaction_type_description='Payments Received'),&#xA;&#x9;&#x9;   case  f2.SELN_TYPE2_CODE&#xA;&#x9;&#x9;   when 'HCPEAST' then '8'&#xA;&#x9;&#x9;   when 'HCPNORTH' then '9'&#xA;&#x9;&#x9;   when 'HCPSOUTH' then '11'&#xA;&#x9;&#x9;   when 'HCPWEST' then '12'&#xA;&#x9;&#x9;   when 'HCPYLNB' then '10'&#xA;&#x9;&#x9;   end,&#xA;                                  (select responsible_party_key from  CONFORM_comcare.responsible_party_dim&#x9;  where   given_name='-' and current_row_indicator='Y' ),  --set default key&#x9;&#x9;&#xA;&#x9;&#x9;    f1.amt1*(-1),&#xA;&#x9;&#x9;&#x9;0.0,&#xA;                                f1.narr1+' '+&#x9;  f1.narr2,&#xA;&#x9;&#x9;   case f1.doc_type &#xA;&#x9;&#x9;&#x9;when 'DDRECCC' then   f1.narr1+' '+&#x9;  f1.narr2&#xA;&#x9;&#x9;&#x9;else &#x9;Narr1 + '  '+ convert(varchar(10),f1.PDATEI,103)&#xA;&#x9;&#x9;&#x9;end,&#xA;                                  f1.narr1+' '+&#x9;  f1.narr2,&#xA;                                'T1'&#xA;&#xA;from extract.GLF_LDG_ACC_TRANS as f1&#xA;inner join&#xA;(&#xA; select t2.USER_FLD1 as ComCarePID, t1.* ,t3.start_date_of_claim&#xA; from extract.[GLF_CHART_ACCT] as t1&#xA; inner join extract.[GLF_CHART_ACC_USF] as t2&#x9;&#x9; on t1.ACCNBRI=t2.ACCNBRI COLLATE DATABASE_DEFAULT&#xA;  inner join &#x9;( select client_id,min(start_date_of_claim) as start_date_of_claim&#xA;                                from extract_comcare.fc_client_contract  where   program_id in (3,4,5,6,7)&#xA;                                 group by &#x9;client_id)  &#x9; as t3 on t2.USER_FLD1=t3.client_id&#x9;&#x9;       ----just pick up home care client to exclude some clients who have home care package and CHSP or other contracts.&#xA; where t1.chart_name ='ARCHART'&#xA; and t2.CHART_NAME= 'ARCHART'&#xA; and t2.USER_FLD1 is not null&#xA; and t1.SELN_TYPE1_CODE='CLIENTCC'&#xA; and t1.SELN_TYPE2_CODE like 'HCP%' --- Home Care&#xA;&#xA;) as f2&#xA;on f1.ACCNBRI=f2.ACCNBRI COLLATE DATABASE_DEFAULT and f1.DOC_DATEI1&gt;=f2.start_date_of_claim                      -----------------------------------------------------------------------------------------------------------payment transaction date should great than home care contract start date&#xA;   inner join conform_comcare.customer_dim as d1 on f2.ComCarePID=d1.client_id and d1.current_row_indicator='Y'&#xA;    left join conform_comcare.date_dim as d2 on convert(date,f1.DOC_DATEI1)=convert(date,d2.full_date)&#xA;where f1.ldg_name ='R1'&#xA;---and f1.doc_type in ('DDRECCC','CANDDCC','BPAYRECCC','CANBPYCC','BPAYRECCCN','CANBPYCN','CDCRECCC','CANCDCRC','ARINVCCP','BPRECCCP','RECCCNP','DDRECCCP')  --- added last four doc_type for new T1 payment types by Jerry Shen at 16/05/2017&#xA;and f1.doc_type in ('PKGRECCC')&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;--Step4: get data for client pay by others for new doc types for future.&#xA;&#xA;insert into conform_comcare.customer_transactions_fact&#xA;    select&#xA;&#x9;       d3.customer_key,  &#xA;&#x9;       isnull(d2.date_key, '9999999') ,&#xA;&#x9;&#x9;   (select transaction_type_key from conform_comcare.transaction_type_dim where transaction_type_description='Payments Received'),&#xA;&#x9;&#x9;   case  f2.SELN_TYPE2_CODE&#xA;&#x9;&#x9;   when 'HCPEAST' then '8'&#xA;&#x9;&#x9;   when 'HCPNORTH' then '9'&#xA;&#x9;&#x9;   when 'HCPSOUTH' then '11'&#xA;&#x9;&#x9;   when 'HCPWEST' then '12'&#xA;&#x9;&#x9;   when 'HCPYLNB' then '10'&#xA;&#x9;&#x9;   end,&#xA;                                  (select responsible_party_key from  CONFORM_comcare.responsible_party_dim&#x9;  where   given_name='-' and current_row_indicator='Y' ),  --set default key&#x9;&#x9;&#xA;&#x9;&#x9;    f1.amt1*(-1),&#xA;&#x9;&#x9;&#x9;0.0,&#xA;                                f1.narr1+' '+&#x9;  f1.narr2,&#xA;&#x9;&#x9; case f1.doc_type &#xA;&#x9;&#x9;&#x9;when 'DDRECCC' then   f1.narr1+' '+&#x9;  f1.narr2&#xA;&#x9;&#x9;&#x9;else &#x9;Narr1 + '  '+ convert(varchar(10),f1.PDATEI,103)&#xA;&#x9;&#x9;&#x9;end,&#xA;                                  f1.narr1+' '+&#x9;  f1.narr2,&#xA;                                     'T1'&#xA;&#xA;from extract.GLF_LDG_ACC_TRANS as f1&#xA;inner join&#xA;(&#xA; select t2.USER_FLD1 as ComCarePID, t1.*,t3.start_date_of_claim&#xA; from extract.[GLF_CHART_ACCT] as t1&#xA; inner join extract.[GLF_CHART_ACC_USF] as t2   on t1.ACCNBRI=t2.ACCNBRI   COLLATE DATABASE_DEFAULT&#xA;  inner join &#x9;( select client_id,min(start_date_of_claim) as start_date_of_claim&#xA;                                from extract_comcare.fc_client_contract  where   program_id in (3,4,5,6,7)&#xA;                                 group by &#x9;client_id)  &#x9; as t3 on t2.USER_FLD1=t3.client_id&#x9;&#x9;       ----just pick up home care client to exclude some clients who have home care package and CHSP or other contracts.&#xA; where t1.chart_name ='ARCHART'&#xA; and t2.CHART_NAME= 'ARCHART'&#xA; and t2.USER_FLD1 is not null&#xA; and t1.SELN_TYPE1_CODE='CLIENTCC'&#xA; and t1.SELN_TYPE2_CODE like 'HCP%' --- Home Care&#xA;&#xA;) as f2&#xA;on f1.ACCNBRI=f2.ACCNBRI COLLATE DATABASE_DEFAULT  and f1.DOC_DATEI1&gt;=f2.start_date_of_claim                      -----------------------------------------------------------------------------------------------------------payment transaction date should great than home care contract start date&#xA;      &#xA;left join conform_comcare.date_dim as d2 on convert(date,f1.DOC_DATEI1)=convert(date,d2.full_date)&#xA;inner join &#xA;   -- get comcare bill to relationship&#xA;&#x9;   (&#xA;&#x9;   &#x9;  select t1.client_cb_id,t1.client_id,t1.billing_start_date,t1.billing_end_date&#x9;,&#xA;          t2.Client_Contract_Billed_To_ID,t2.client_cb_id as client_cb_id2,t2.Effective_From_Date,t2.Effective_To_Date ,&#xA;&#x9;    &#x9;t3.Client_Contract_Billed_To_ID as Client_Contract_Billed_To_ID2,t3.person_id as debtor_id,t3.Split_Percentage&#xA;           from  extract_comcare.FB_Client_Contract_Billing as t1&#x9;&#x9;&#xA;            inner join  extract_comcare.FB_Client_Contract_Billed_To as t2   on t1.Client_CB_ID=t2.Client_CB_ID&#xA;            inner join  extract_comcare.FB_Client_CB_Split as t3 on &#x9;t3.Client_Contract_Billed_To_ID = t2.Client_Contract_Billed_To_ID&#xA;            where t1.&#x9;Funder_Contract_ID  in (3,4,5,6,7)&#xA;&#x9;&#x9;&#x9;and t1.client_id &lt;&gt;t3.Person_ID&#xA;&#x9;   &#xA;&#x9;   &#xA;&#x9;   )&#x9; as ff on  f2.ComCarePID=ff.debtor_id&#xA;&#xA;&#x9;   inner join conform_comcare.customer_dim as d3 on ff.Client_ID=d3.client_id and d3.current_row_indicator='Y'&#xA;&#x9;   &#xA;where f1.ldg_name ='R1'&#xA;--and f1.doc_type in ('DDRECCC','CANDDCC','BPAYRECCC','CANBPYCC','BPAYRECCCN','CANBPYCN','CDCRECCC','CANCDCRC','ARINVCCP','BPRECCCP','RECCCNP','DDRECCCP')  --- added last four doc_type for new T1 payment types by Jerry Shen at 16/05/2017&#xA;and f1.doc_type in ('PKGRECCC')  &#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\T1-Opening Balance From CIM - once"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{714b1d42-b3bd-4149-a4aa-164ac6b0976c}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="T1-Opening Balance From CIM - once"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{036387CF-70D3-4FDA-8C0E-A48875FBFE17}"
                  SQLTask:SqlStatementSource="---in T1 CIM opening balance import date was 29/04/2016&#xA;--to calculate right opening balnce, changed the import date to 20/04/2016 as default date&#xA;&#xA; insert into conform_comcare.customer_transactions_fact&#xA;   select&#xA;&#x9;       d1.customer_key,  &#xA;&#x9;       isnull(d2.date_key, '9999999') ,&#xA;&#x9;&#x9;   (select transaction_type_key from conform_comcare.transaction_type_dim where transaction_type_description='Opening Balance from CIM'),&#xA;&#x9;&#x9;   case  f1.narr2&#xA;&#x9;&#x9;   when 'CDC East' then '8'&#xA;&#x9;&#x9;   when 'CDC North' then '9'&#xA;&#x9;&#x9;   when 'CDC South' then '11'&#xA;&#x9;&#x9;   when 'CDCWest' then '12'&#xA;&#x9;&#x9;   when 'CDC Gawler' then '10'&#xA;&#x9;&#x9;   else    '10'&#xA;&#x9;&#x9;   end,&#xA;         (select responsible_party_key from  CONFORM_comcare.responsible_party_dim&#x9;  where   given_name='-' and current_row_indicator='Y' ),  --set default key&#x9;&#x9;&#xA;&#x9;&#x9;    f1.amt1*(-1),                         ------ changed by JS at 17/05/2017 after conversion with Freya&#xA;&#x9;&#x9;&#x9;0.0,&#xA;            case f1.doc_type &#xA;&#x9;&#x9;&#x9;when 'DDRECCC' then   f1.narr1+' '+&#x9;  f1.narr2&#xA;&#x9;&#x9;&#x9;else &#x9;Narr1 + '  '+ convert(varchar(10),f1.PDATEI,103)&#xA;&#x9;&#x9;&#x9;end,&#xA;&#x9;&#x9;   case f1.doc_type &#xA;&#x9;&#x9;&#x9;when 'DDRECCC' then   f1.narr1+' '+&#x9;  f1.narr2&#xA;&#x9;&#x9;&#x9;else &#x9;Narr1 + '  '+ convert(varchar(10),f1.PDATEI,103)&#xA;&#x9;&#x9;&#x9;end,&#xA;                                  f1.narr1+' '+&#x9;  f1.narr2,&#xA;                                'T1-CIM'&#xA;&#xA;from extract.GLF_LDG_ACC_TRANS as f1&#xA;   inner join conform_comcare.customer_dim as d1 on SUBSTRING(f1.accnbri,3,8)=d1.client_id and d1.current_row_indicator='Y'&#xA;  ----  left join conform_comcare.date_dim as d2 on convert(date,f1.DOC_DATEI1)=convert(date,d2.full_date)&#xA;  left join conform_comcare.date_dim as d2 on convert(date,'2016-04-20 00:00:00.000')=convert(date,d2.full_date)&#xA;where f1.ldg_name  in ('CNLDG')&#xA;and f1.doc_type ='GLJNL'&#xA;and f1.Narr1='Opening Balance from CIM'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{6C6B10AE-3DBB-4193-8C0F-D6EA48869EB4}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\EST - Write Job Start info"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\Delete Existing Data" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{8374C674-B25F-453B-B6DA-8A9D6C549D4A}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\Delete Existing Data"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\ComCare FC_Transaction" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.PrecedenceConstraints[Constraint 2]"
              DTS:CreationName=""
              DTS:DTSID="{F3ADF510-32A2-49FB-A82F-1121947786FB}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\ComCare FC_Transaction"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 2"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\T1 Payment" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{477B2669-626F-4687-9686-D9511AC7CF39}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\T1 Payment"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\T1-Opening Balance From CIM - once" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.PrecedenceConstraints[Constraint 4]"
              DTS:CreationName=""
              DTS:DTSID="{7891A2F3-1CAB-4F3B-9DA9-5C26EB133C00}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\CIM historic transaction - just import once"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 4"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\EST - Write Job Finish info" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.PrecedenceConstraints[Constraint 5]"
              DTS:CreationName=""
              DTS:DTSID="{10B87321-44B5-45BF-AB1F-39483CC78BA3}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\T1-Opening Balance From CIM - once"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 5"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\CIM historic transaction - just import once" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{A2929194-A54D-4324-98B5-68F6BE606D82}"
              DTS:EventID="244"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{1A8E3545-19FF-4B36-A302-D0D607720794}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{181841F3-AE12-4AA6-87D5-CB4A4343F48D}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Execute SQL Task - Catch Error Details">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{E85ED4B0-760B-483B-A76C-D79EA17A6DAC}"
                      SQLTask:SqlStatementSource="-- insert into management.ERROR_EVENT_DETAIL_FACT table&#xA;&#xA;insert into management.ERROR_EVENT_DETAIL_FACT&#xA;SELECT &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,T2.TABLE_KEY&#xA;,T2.TABLE_KEY&#xA;,?&#xA;,' '&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;&#xA;-- insert into [management].ETL_PROCESS_FACT with 'Failed'&#xA;INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,3&#xA;,GETDATE() &#xA;,4&#xA;,'Update Fact Table'    &#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA; -- insert into management.ERROR_EVENT_FACT table&#xA;insert into management.ERROR_EVENT_FACT&#xA;SELECT &#xA;(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,convert(varchar, getdate(),21)&#xA;, 'HIGH'&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ParameterBinding
                        SQLTask:ParameterName="0"
                        SQLTask:DtsVariableName="System::ErrorDescription"
                        SQLTask:ParameterDirection="Input"
                        SQLTask:DataType="130"
                        SQLTask:ParameterSize="-1" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{E8B269EC-21B2-4426-9452-C2D51356122E}"
      DTS:EventID="1701257339"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{CB3DB83B-5192-47B0-B906-4BE479DCBA20}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables />
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="268,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\CIM historic transaction - just import once"
          TopLeft="24.75,398" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\ComCare FC_Transaction"
          TopLeft="29.75,156" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\Delete Existing Data"
          TopLeft="31.75,91" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\EST - Write Job Finish info"
          TopLeft="25.75,526" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\EST - Write Job Start info"
          TopLeft="30.75,15" />
        <NodeLayout
          Size="271,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\T1 Payment"
          TopLeft="25.75,244" />
        <NodeLayout
          Size="268,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT\T1-Opening Balance From CIM - once"
          TopLeft="23.75,330" />
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.PrecedenceConstraints[Constraint]"
          TopLeft="166.75,57">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,34"
              Start="0,0"
              End="0,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.PrecedenceConstraints[Constraint 1]"
          TopLeft="166.25,133">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,23"
              Start="0,0"
              End="0,15.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.PrecedenceConstraints[Constraint 2]"
          TopLeft="163.25,198">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,46"
              Start="0,0"
              End="0,38.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,38.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.PrecedenceConstraints[Constraint 3]"
          TopLeft="159.5,286">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,44"
              Start="0,0"
              End="0,36.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,36.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.PrecedenceConstraints[Constraint 4]"
          TopLeft="160,440">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,86"
              Start="0,0"
              End="0,78.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,78.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.PrecedenceConstraints[Constraint 5]"
          TopLeft="158.25,372">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,26"
              Start="0,0"
              End="0,18.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,18.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="382,626"
          Size="382,669"
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT"
          TopLeft="56,83" />
        <AnnotationLayout
          Text="Run FACT ETL Steps:&#xA;1. Run ETL in T1 to export  comcare_debtor_receipts&#xA;2. Import it into DWH using Import_T1_receipts_fromexportfile_needto  to update data.dtsx&#xA;--- above steps, just run once before go live&#xA;&#xA;3. Extract T1 transaction table from T1 --- make sure build auto process in DWH&#xA;&#xA;4. Run Extrat, dim ETL&#xA;&#xA;5. Run Fact ETL&#xA;&#xA;6. Develivery "
          ParentId="Package\Sequence Container - Fact Tables"
          FontInfo="{x:Null}"
          Size="487,233"
          Id="6e01550a-d159-49d8-aba2-576e476076e4"
          TopLeft="465,90" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="1192,6878"
          Size="1192,6921"
          Id="Package\Sequence Container - Fact Tables"
          TopLeft="34.5,41" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="264,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - CUSTOMER_TRANSACTION_FACT.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
          TopLeft="448,222" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>