<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="8/23/2016 2:19:29 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="W7PC01XQ1T"
  DTS:CreatorName="ANGLICARE-SA\jshen"
  DTS:DTSID="{6DB2316E-CE42-4B09-8609-FE52BF1A9A9D}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="13.0.2164.0"
  DTS:LocaleID="3081"
  DTS:ObjectName="Conform_Fact - DEV"
  DTS:PackageType="5"
  DTS:ProtectionLevel="0"
  DTS:VersionBuild="640"
  DTS:VersionGUID="{86FC992D-7A2B-4AC8-A8BE-6CCDCACF9A6D}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[devsql-1\whouse.DWHB.asadwh]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{BF90892F-2F5D-47CF-A2FA-4F3850A04535}"
      DTS:ObjectName="devsql-1\whouse.DWHB.asadwh">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=devsql-1\whouse;Initial Catalog=DWHB;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[devsql-1\whouse.DWHB.asadwh 1]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{6B844CC6-0F5A-4327-899C-E5FE6584670F}"
      DTS:ObjectName="devsql-1\whouse.DWHB.asadwh 1">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=devsql-1\whouse;Initial Catalog=DWHB;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CC74842B-34A0-4B10-A6AD-BC23AD8039AD}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="anniversary_date_key">
      <DTS:VariableValue
        DTS:DataType="3">9999999</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{8C96DFF2-D4F0-4A0B-8E56-96B6C6E96DF5}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="change_reason_code_new">
      <DTS:VariableValue
        DTS:DataType="8">N</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{367595F9-7886-4944-964F-93BCD4C4D23D}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="change_reason_code_update">
      <DTS:VariableValue
        DTS:DataType="8">U</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F0942BB2-A557-42EB-A246-E2647CC06B8E}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="change_reason_description_new">
      <DTS:VariableValue
        DTS:DataType="8">NEW</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{5F963C1F-DFC6-4C14-B462-56654CF8E014}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="change_reason_description_update">
      <DTS:VariableValue
        DTS:DataType="8">UPDATE</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{A3BF0FB3-A228-476E-82F5-BCF184AF55C2}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="current_row_indicator">
      <DTS:VariableValue
        DTS:DataType="8">Y</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{85397108-740B-48F7-8217-B9643EA7C126}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="GETDATE()"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="etl_start_date">
      <DTS:VariableValue
        DTS:DataType="7">8/3/2017 11:03:42 AM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F0E172DC-A7CB-4EE0-9578-EA330BB74667}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="manager_pos_key">
      <DTS:VariableValue
        DTS:DataType="3">1694</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CCAE94E7-7B0B-4DAB-BC21-2DE23D965D34}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="manger_key">
      <DTS:VariableValue
        DTS:DataType="3">1780</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E92992E9-5DD3-42B9-BC33-2E531B0B5145}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="new_position_flag">
      <DTS:VariableValue
        DTS:DataType="8">Y</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4C1D89BD-73AE-4455-A1D1-F466789D712E}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="position_vacant_date_key">
      <DTS:VariableValue
        DTS:DataType="3">9999999</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{1BA5A3E8-2B2C-45E5-B1DD-DF02E7543A84}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="GETDATE()"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="row_effective_date">
      <DTS:VariableValue
        DTS:DataType="7">8/3/2017 11:03:42 AM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3CC1B8BD-D845-4EBA-B055-DC77257F0D23}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="GETDATE()"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="row_expiration_date">
      <DTS:VariableValue
        DTS:DataType="7">8/3/2017 11:03:42 AM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{562512CA-AE66-4665-B126-F47B8CD33899}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="survery_completed">
      <DTS:VariableValue
        DTS:DataType="8">NO</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Sequence Container - Fact Tables"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Sequence Container"
      DTS:DTSID="{EC7FBD86-B585-42D4-96AB-F010995189E8}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Sequence Container - Fact Tables">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Sequence Container"
          DTS:DTSID="{8EA6259A-8927-4D20-95F1-D4A36ABB04BC}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="SD1 - DEBTOR_FACT">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\EST - Write Job Finish info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{E278CD8B-392F-42AC-8C06-7F5826D06B45}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Finish info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{6B844CC6-0F5A-4327-899C-E5FE6584670F}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,2&#xA;,GETDATE() ,&#xA;4,&#xA;'Finish updating FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_finance.debtor_fact'&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\EST - Write Job Start info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{849B4079-7551-42BE-8A69-5047EF668F59}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Start info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{6B844CC6-0F5A-4327-899C-E5FE6584670F}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,1&#xA;,GETDATE() ,&#xA;4,&#xA;'Start to update FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_finance.debtor_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\Get new records and update columns"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{7F3C4961-1708-4AC1-96B3-765A08A91CA8}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Get new records and update columns"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{6B844CC6-0F5A-4327-899C-E5FE6584670F}"
                  SQLTask:SqlStatementSource="   --temp table &#xA;   declare @debtorglmap TABLE&#xA;   (&#xA;   ldg_name varchar(20),&#xA;   accnbri varchar(20),&#xA;   doc_ref1 varchar(20),&#xA;   amt1 decimal(14,2),&#xA;   cost_ldg_name varchar(20),&#xA;   cost_accnbri varchar(20),&#xA;   cost_amt1 decimal(14,2),&#xA;   cost_centre_key int&#x9;   &#xA;   ) ;&#xA;&#xA;   insert into &#x9;@debtorglmap&#xA;     select &#xA;    r1.*,&#xA;&#x9;cost.ldg_name as cost_ldg_name,&#xA;&#x9;cost.ACCNBRI as cost_accnbri&#x9;,&#xA;&#x9;cost.AMT1 as cost_amt1 &#x9;,&#xA;&#x9;isnull(d1.cost_centre_key,&#x9;  (select cost_centre_key from conform_finance.cost_centre_dim where  ldg_name='No Cost' and current_row_indicator='Y' ) )&#xA;&#x9; &#xA;  from &#xA;  (&#xA;    select ldg_name,ACCNBRI,doc_ref1,amt1 &#xA;   from  extract.glf_ldg_acc_trans&#xA;   where ldg_name='R1'  and  len(doc_ref1)&gt;0&#xA;   ) as r1&#xA;   inner join&#xA;   (&#xA;   select ldg_name,ACCNBRI,doc_ref1,amt1 &#xA;   from  extract.glf_ldg_acc_trans&#xA;   where ldg_name like '%ACT' and len(ACCNBRI)=15 and  len(doc_ref1)&gt;0&#xA;   ) as cost&#xA;   on r1.DOC_REF1=cost.DOC_REF1&#x9;     and abs(r1.AMT1)=abs(cost.AMT1)&#xA;   left join conform_finance.cost_centre_dim as d1 on cost.ldg_name=d1.ldg_name and cost.ACCNBRI= d1.accnbri&#x9;and d1.current_row_indicator='Y'&#xA;&#xA;&#xA;    select ldg_name,ACCNBRI,doc_ref1,amt1 &#xA;   from  extract.glf_ldg_acc_trans&#xA;   where ldg_name='R1'  and  len(doc_ref1)&gt;0&#xA;&#xA;&#xA;  insert into conform_finance.debtor_fact&#xA;  select &#xA;  d1.account_key,&#xA;   isnull(f1.cost_centre_key, (select cost_centre_key from conform_finance.cost_centre_dim where  ldg_name='No Cost' and current_row_indicator='Y' ) ),&#xA;  (select portfolio_key from conform_finance.portfolio_dim where portfolio_name like 'No Portfolio%' and &#x9;   current_row_indicator='Y' ),&#xA;  (select service_stream_key from conform_finance.service_stream_dim where service_stream_name like 'No Service%' and &#x9;   current_row_indicator='Y' ),&#xA;  (select program_key from conform_finance.program_dim where program_name like 'No Prog%' and &#x9;   current_row_indicator='Y' ),&#xA;  ISNULL(d5.accounting_period_key,(select accounting_period_key from conform_finance.accounting_period_dim  where fiscal_year like 'No Period%' and current_row_indicator='Y' )&#x9;) ,&#xA;  d2.date_key,&#xA;  d3.date_key,&#xA;  d4.ledger_key,&#xA;  t1.DOC_REF1,&#xA;  t1.AMT1  ,&#xA;  t1.DUE_DATEI,&#xA;  t1.NARR1,&#xA;  t1.NARR2,&#xA;  t1.NARR3,&#xA; t1.doc_type,&#xA;  case &#x9;&#xA;  when DUE_DATEI &lt;&gt; '1900-01-01 00:00:00.000'  then   Datediff(day,t1.due_datei,getdate())&#xA;  else 0&#xA;  end,&#xA;t1.alloc_amt1,&#xA;0&#xA;  from extract.glf_ldg_acc_trans   as t1&#xA;  inner join conform_finance.account_dim as d1 on t1.ACCNBRI=d1.account_number and d1.chart_name='ARCHART' and d1.current_row_indicator='Y'&#xA;  inner join conform_finance.date_dim as d2 on t1.DOC_DATEI1=d2.full_date&#xA;  inner join conform_finance.date_dim as d3 on t1.PDATEI=d3.full_date&#xA;  inner join conform_finance.ledger_dim as d4 on t1.ldg_name =d4.name and d4.current_row_indicator='Y'&#xA;  left join conform_finance.accounting_period_dim as d5 on t1.PERIOD=d5.period_no and convert(date,t1.DOC_DATEI1)=convert(date,d5.full_date)&#xA;  left join&#x9; @debtorglmap as f1 on t1.ACCNBRI=f1.ACCNBRI and t1.DOC_REF1=f1.DOC_REF1  &#xA;  where t1.ldg_name ='R1'&#xA;&#xA;&#xA;update conform_finance.debtor_fact&#xA;set outstanding_amt = alloc_amt1- amount&#xA;where doc_type ='ARINV';&#xA;&#xA;-----------------------------------------------------update org_structure-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xA;--Step1: based on program_key.&#xA;--update program_key&#xA;&#xA;  update t1&#xA;  set &#x9;t1.program_key=t3.program_key&#xA;  from conform_finance.debtor_fact as t1&#xA;  inner join   conform_finance.account_dim as d1 on t1.account_key=d1.account_key and d1.chart_name='ARCHART' and d1.current_row_indicator='Y'&#xA;  inner join    extract.GLF_CHART_ACCT as t2 on d1.account_number=t2.ACCNBRI and t2.CHART_NAME='ARCHART'&#xA;  inner join conform_finance.program_mapping as t3 on t2.SELN_TYPE2_CODE = t3.value1 and t3.program_key is not null&#xA;&#xA;&#xA;--update service_stream and porfolio_key&#xA;&#xA;    update f1&#xA;  set &#x9;f1.service_stream_key=d2.service_stream_key&#x9;,&#xA;        f1.portfolio_key=d3.portfolio_key&#xA;  from conform_finance.debtor_fact as f1&#xA;  inner join conform_finance.program_dim as d1 on f1.program_key=d1.program_key and d1.current_row_indicator='Y' and f1.program_key&lt;&gt; (select program_key from conform_finance.program_dim where program_name like 'No Prog%' and &#x9;   current_row_indicator='Y')&#xA;  inner join &#xA;    ( --get all org based on names&#xA;&#x9;&#x9;select distinct t1.program_code,t1.service_stream_code,t2.portfolio_code , d1.program_name  ,d2.service_stream_name ,d3.portfolio_name ,d1.program_key,d2.service_stream_key,d3.portfolio_key&#xA;&#x9;&#x9;from conform.program_temp  as t1&#xA;&#x9;&#x9;inner join conform.service_stream_temp as t2   on t1.service_stream_code=t2.service_stream_code&#xA;&#x9;&#x9;inner join conform.program_dim as d1 on t1.program_code=d1.program_code and d1.current_row_indicator='Y'&#xA;&#x9;&#x9;inner join conform.service_stream_dim as d2 on t1.service_stream_code=d2.service_stream_code and d1.current_row_indicator='Y'&#xA;&#x9;&#x9;inner join conform.portfolio_dim as d3 on t2.portfolio_code=d3.portfolio_code and d1.current_row_indicator='Y'&#xA;    )&#x9;as f2&#xA;&#x9;on d1.program_name=f2.program_name&#xA;&#x9;inner join conform_finance.service_stream_dim as d2 on f2.service_stream_name=d2.service_stream_name   and d2.current_row_indicator='Y'&#xA;&#x9;inner join conform_finance.portfolio_dim as d3 on f2.portfolio_name=d3.portfolio_name and d3.current_row_indicator='Y'&#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\Truncate table"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{5AB5ABB7-9067-4D4B-87C4-0144D581E923}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Truncate table"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{6B844CC6-0F5A-4327-899C-E5FE6584670F}"
                  SQLTask:SqlStatementSource="truncate table  conform_finance.debtor_fact" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{81819812-CD0E-4548-9F35-BF7124F756C0}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\EST - Write Job Start info"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\Truncate table" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{2B28722D-0B49-4504-A642-E50630A8F1DC}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\Truncate table"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\Get new records and update columns" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT.PrecedenceConstraints[Constraint 2]"
              DTS:CreationName=""
              DTS:DTSID="{0BF07C75-3E87-4477-B54D-C8EB4B3625C8}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\Get new records and update columns"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 2"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\EST - Write Job Finish info" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{8868727B-4220-46B2-BC7B-41448AA244A0}"
              DTS:EventID="244"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{84240020-6C38-4484-B7F3-35216A964D7F}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{4982DC4A-388C-4508-8541-61BB3B4DB4F7}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Execute SQL Task - Catch Error Details">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{6B844CC6-0F5A-4327-899C-E5FE6584670F}"
                      SQLTask:SqlStatementSource="-- insert into management.ERROR_EVENT_DETAIL_FACT table&#xA;&#xA;insert into management.ERROR_EVENT_DETAIL_FACT&#xA;SELECT &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,T2.TABLE_KEY&#xA;,T2.TABLE_KEY&#xA;,?&#xA;,' '&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;&#xA;-- insert into [management].ETL_PROCESS_FACT with 'Failed'&#xA;INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,3&#xA;,GETDATE() &#xA;,4&#xA;,'Update Fact Table'    &#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA; -- insert into management.ERROR_EVENT_FACT table&#xA;insert into management.ERROR_EVENT_FACT&#xA;SELECT &#xA;(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,convert(varchar, getdate(),21)&#xA;, 'HIGH'&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ParameterBinding
                        SQLTask:ParameterName="0"
                        SQLTask:DtsVariableName="System::ErrorDescription"
                        SQLTask:ParameterDirection="Input"
                        SQLTask:DataType="130"
                        SQLTask:ParameterSize="-1" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Sequence Container"
          DTS:DTSID="{ec48c605-7a18-4196-bc76-9121bfd136b9}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="SD1 - KPI_FACT">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\EST - Write Job Finish info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{cdd1d7e4-1e5b-4baa-bb2a-f9e022e1d0d7}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Finish info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{6B844CC6-0F5A-4327-899C-E5FE6584670F}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,2&#xA;,GETDATE() ,&#xA;4,&#xA;'Finish updating FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_finance.debtor_fact'&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\EST - Write Job Start info"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{0a182037-dd04-45d3-b37e-6695d4d75b91}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="EST - Write Job Start info"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{6B844CC6-0F5A-4327-899C-E5FE6584670F}"
                  SQLTask:SqlStatementSource="INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,1&#xA;,GETDATE() ,&#xA;4,&#xA;'Start to update FACT table'&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform_finance.debtor_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\Get new records and update columns"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{4de82e98-e6b9-44ea-99ea-fc55c38d8173}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Get new records and update columns"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{6B844CC6-0F5A-4327-899C-E5FE6584670F}"
                  SQLTask:SqlStatementSource="-----------------------------------------------------------process to calculate ---------------------------------------------------------------------------&#xA;--define variable&#xA;--kpi_report_date&#xA;declare @v_date datetime ='2017-05-01 00:00:00.000';&#xA;--financial_month_no&#xA;declare @v_fymont_no int = (select financial_month_no from conform_finance.date_dim where full_date =@v_date) &#xA;--entity no&#xA;declare @endity varchar(20) ='10';&#xA;&#xA;--delete existing data for same period&#xA;delete from  [conform_finance].kpi_fact&#xA;where date_key = (select date_key from conform_finance.date_dim where full_date =@v_date);&#xA;&#xA;--start to populate KPI data for this period&#xA;--------------------------------------KPI1.Balancesheet Debt to Equity ------------------------------------------------------------------------------------&#xA;&#xA; insert into   [conform_finance].kpi_fact&#xA; select &#xA; 'Balancesheet Debt to Equity',&#xA;(select date_key from conform_finance.date_dim where full_date =@v_date),&#xA;'Debt',&#x9;&#x9;&#xA;(select sum( convert(decimal(20,2),amount))/1000 * (-1) from &#x9;  extract.GLF_Period_Balance_forKPI&#xA;where Entity in (@endity)&#xA;and period &lt;=@v_fymont_no&#xA;and account_group ='NCL'&#xA;and Account_Sub_Group='NCLFACIL'),&#xA;'Equity',&#xA;(&#xA;--reserversL&#xA;select&#xA;(&#xA;select sum( convert(decimal(20,2),amount))/1000 * (-1) from &#x9;  extract.GLF_Period_Balance_forKPI&#xA;where Entity in (@endity)&#xA;and period &lt;=@v_fymont_no&#xA;and account_group ='EQU'&#xA;)&#xA;-&#xA;(select sum( convert(decimal(20,2),amount))/1000 * (-1) from &#x9;  extract.GLF_Period_Balance_forKPI&#xA;where Entity in (@endity)&#xA;and period &lt;=@v_fymont_no&#xA;and Account_Sub_Group ='EQRE'&#xA;)&#xA;+  &#xA;&#xA;--Retained Surplus &#xA;(&#xA;select &#xA;&#xA;(select sum( convert(decimal(20,2),amount))/1000 *(-1)  from &#x9;  extract.GLF_Period_Balance_forKPI&#xA;where Entity in (@endity)&#xA;and period &lt;=@v_fymont_no&#xA;and Account_Sub_Group ='EQRE'&#xA;and account_group ='EQU'&#xA;)&#xA;+&#xA;(&#xA;select sum( convert(decimal(20,2),isnull(amount,0)))/1000*(-1) from &#x9;  extract.GLF_Period_Balance_forKPI&#xA;where Entity in (@endity)&#xA;and period &lt;=@v_fymont_no&#xA;and right(account_type,1) in (4,6)&#xA;&#xA;)&#xA;&#xA;)&#xA;),&#xA;null,&#xA;null,&#xA;null,&#xA;null,&#xA;'Result',&#xA;0.00,&#xA;null,&#xA;null,&#xA;'Recommended Maximum',&#xA;0.30,&#xA;null,&#xA;null;&#xA;&#xA;--update result&#xA;update &#x9;[conform_finance].kpi_fact&#xA;set kpi_result_1_value =kpi_indicator_1_value / kpi_indicator_2_value&#xA;where kpi_name ='Balancesheet Debt to Equity'&#xA;and date_key =(select date_key from conform_finance.date_dim where full_date =@v_date) ;&#xA;&#xA;--------------------------------------KPI2.Balance sheet: Current Ratio adjusted for Resident Bonds--------------------------------------------&#xA;insert into   [conform_finance].kpi_fact&#xA; select &#xA; 'Balance sheet: Current Ratio adjusted for Resident Bonds',&#xA;(select date_key from conform_finance.date_dim where full_date =@v_date),&#xA;'Current Assets',&#x9;&#x9;&#xA;(select sum( convert(decimal(20,2),amount))/1000 from &#x9;  extract.GLF_Period_Balance_forKPI&#xA;where Entity in (@endity)&#xA;and period &lt;=@v_fymont_no&#xA;and account_group ='CA'),&#xA;'Current Liabilities',&#xA;(select sum( convert(decimal(20,2),amount))/1000*(-1) from &#x9;  extract.GLF_Period_Balance_forKPI&#xA;where Entity in (@endity)&#xA;and period &lt;=@v_fymont_no&#xA;and account_group in ('CL')),&#xA;'Resident Bonds',&#xA;29846,&#xA;null,&#xA;null,&#xA;'Result',&#xA;0.00,&#xA;null,&#xA;null,&#xA;'Recommended Minimum',&#xA;1.5,&#xA;null,&#xA;null;&#xA;&#xA;--update result&#xA;update &#x9;[conform_finance].kpi_fact&#xA;set kpi_result_1_value =kpi_indicator_1_value / kpi_indicator_2_value&#xA;where kpi_name ='Balance sheet: Current Ratio adjusted for Resident Bonds'&#xA;and date_key =(select date_key from conform_finance.date_dim where full_date =@v_date) ;&#xA;&#xA;&#xA;-----------------------------------KPI3:EBITDA : Budget----------------------------------------------------------------------------------------&#xA; insert into   [conform_finance].kpi_fact&#xA; select &#xA; 'EBITDA : Budget',&#xA; (select date_key from conform_finance.date_dim where full_date =@v_date),&#xA;'EBITDA Actual ',&#xA;(&#xA;select &#xA;&#xA;(&#xA;&#xA; select sum( convert(decimal(16,2),amount))/1000  from &#x9;  extract.GLF_Period_Balance_forKPI&#xA;where Entity='10'&#xA;and period &lt;=@v_fymont_no&#xA;and Management_Report_L2  in ('DEPEXP','INTEXP')&#xA;and account_type in (4,6)&#xA;)&#xA;&#xA;+&#xA;(&#xA; select sum( convert(decimal(16,2),amount))/1000 *(-1) from &#x9;  extract.GLF_Period_Balance_forKPI&#xA;where Entity='10'&#xA;and period &lt;=@v_fymont_no&#xA;and Management_Report_L2  in&#xA;(&#xA;'GOVFUND',&#xA;'RESCLFEE',&#xA;'ACACCINC',&#xA;'RENTRECD',&#xA;'OTHINC',&#xA;'LUNXFUND',&#xA;'SWGIF',&#xA;'SWGCST',&#xA;'SWGHK',&#xA;'SWGCTRNG',&#xA;'ONCOSTS',&#x9;&#xA;'CLNTEXP',&#xA;'FOODBEV',&#xA;'HKPNGEXP',&#xA;'MEDEXP',&#xA;'PURTRST',&#x9;&#xA;'OTHOCEXP',&#xA;'REPMNTRP', &#xA;'ADOFFEXP',&#xA;'FUNDEXP',&#xA;'OTHSTEXP',&#xA;'PRFINEXP',&#xA;'TRVMVH' ,&#xA;'DEPEXP',&#xA;'DISPFA',&#xA;'INTEXP',&#xA;'OHDRECH',&#xA; 'RETENINC',&#xA;'CAPINC',&#xA;'INVINC'   ,&#xA;'NA'&#xA;&#xA;)&#xA;and account_type in (4,6)&#xA;&#xA;&#xA;)  )&#xA;&#xA;,&#xA;'EBITDA Budget',&#xA;7753 ,&#xA;null,&#xA;null,&#xA;null,&#xA;null,&#xA;'Result',&#xA;0.00,&#xA;null,&#xA;null,&#xA;'Recommended Minimum',&#xA;0.0,&#xA;null,&#xA;null;&#xA;&#xA;----------------------------------------KPI4: EBITDA : Turnover-------------------------------------------------------------------------------&#xA; insert into   [conform_finance].kpi_fact&#xA; select &#xA; 'EBITDA : Turnover',&#xA; (select date_key from conform_finance.date_dim where full_date =@v_date),&#xA;'EBITDA',&#xA; (&#xA;select &#xA;&#xA;(&#xA;&#xA; select sum( convert(decimal(16,2),amount))/1000  from &#x9;  extract.GLF_Period_Balance_forKPI&#xA;where Entity='10'&#xA;and period =@v_fymont_no&#xA;and Management_Report_L2  in ('DEPEXP','INTEXP')&#xA;and account_type in (4,6)&#xA;)&#xA;&#xA;+&#xA;(&#xA; select sum( convert(decimal(16,2),amount))/1000 *(-1) from &#x9;  extract.GLF_Period_Balance_forKPI&#xA;where Entity='10'&#xA;and period =@v_fymont_no&#xA;and Management_Report_L2  in&#xA;(&#xA;'GOVFUND',&#xA;'RESCLFEE',&#xA;'ACACCINC',&#xA;'RENTRECD',&#xA;'OTHINC',&#xA;'LUNXFUND',&#xA;'SWGIF',&#xA;'SWGCST',&#xA;'SWGHK',&#xA;'SWGCTRNG',&#xA;'ONCOSTS',&#x9;&#xA;'CLNTEXP',&#xA;'FOODBEV',&#xA;'HKPNGEXP',&#xA;'MEDEXP',&#xA;'PURTRST',&#x9;&#xA;'OTHOCEXP',&#xA;'REPMNTRP', &#xA;'ADOFFEXP',&#xA;'FUNDEXP',&#xA;'OTHSTEXP',&#xA;'PRFINEXP',&#xA;'TRVMVH' ,&#xA;'DEPEXP',&#xA;'DISPFA',&#xA;'INTEXP',&#xA;'OHDRECH',&#xA; 'RETENINC',&#xA;'CAPINC',&#xA;'INVINC'   ,&#xA;'NA'&#xA;&#xA;)&#xA;and account_type in (4,6)&#xA;&#xA;&#xA;)  &#xA;&#xA;)  ,&#xA;'Turnover',&#xA;&#xA;(&#xA;&#xA; select sum( convert(decimal(16,2),amount))/1000*(-1)  from &#x9;  extract.GLF_Period_Balance_forKPI&#xA;where Entity='10'&#xA;and period =@v_fymont_no&#xA;and Management_Report_L2  in ('GOVFUND','RESCLFEE','ACACCINC','RENTRECD','OTHINC','LUNXFUND')&#xA;and account_type in (4,6)&#xA;) &#xA;,&#xA;null,&#xA;null,&#xA;null,&#xA;null,&#xA;'Result',&#xA;0.00,&#xA;null,&#xA;null,&#xA;'Recommended Minimum',&#xA;0.03,&#xA;null,&#xA;null;&#xA;&#xA;&#xA;--update result&#xA;update &#x9;[conform_finance].kpi_fact&#xA;set kpi_result_1_value =kpi_indicator_1_value / kpi_indicator_2_value&#xA;where kpi_name ='EBITDA : Turnover'&#xA;and date_key =(select date_key from conform_finance.date_dim where full_date =@v_date) ;&#xA;&#xA;&#xA;&#xA;&#xA; -------------------------------insert into dwhf_finance kpi_fact table-------------------------------------------------------------------------&#xA; truncate table  dwhf_finance.finance.kpi_fact;&#xA; insert into  dwhf_finance.finance.kpi_fact&#xA; select * &#xA; from [conform_finance].kpi_fact;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\Truncate table"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{7d09bfa1-0b7d-4f74-b014-4b95c9eaceb3}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Truncate table"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{6B844CC6-0F5A-4327-899C-E5FE6584670F}"
                  SQLTask:SqlStatementSource="truncate table  conform_finance.debtor_fact" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{5b841b50-2c25-4bc2-81f6-55210c8d323b}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\EST - Write Job Start info"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\Truncate table" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{b79325f8-ebd4-4f8e-8654-bdd26f570288}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\Truncate table"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\Get new records and update columns" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT.PrecedenceConstraints[Constraint 2]"
              DTS:CreationName=""
              DTS:DTSID="{c808a9c4-244e-4036-bae9-4f148338bbe9}"
              DTS:From="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\Get new records and update columns"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 2"
              DTS:To="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\EST - Write Job Finish info" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{462f70db-8feb-44f8-bbcb-88457a48c56d}"
              DTS:EventID="244"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{7aab03fb-e87d-4fe0-ae7e-d3f4f2a5687c}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{8597932f-99e0-453d-916e-0b829360b04f}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Execute SQL Task - Catch Error Details">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{6B844CC6-0F5A-4327-899C-E5FE6584670F}"
                      SQLTask:SqlStatementSource="-- insert into management.ERROR_EVENT_DETAIL_FACT table&#xA;&#xA;insert into management.ERROR_EVENT_DETAIL_FACT&#xA;SELECT &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,T2.TABLE_KEY&#xA;,T2.TABLE_KEY&#xA;,?&#xA;,' '&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;&#xA;-- insert into [management].ETL_PROCESS_FACT with 'Failed'&#xA;INSERT INTO [management].ETL_PROCESS_FACT&#xA;SELECT  &#xA;(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch')&#xA;, T2.TABLE_KEY&#xA;,3&#xA;,GETDATE() &#xA;,4&#xA;,'Update Fact Table'    &#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA; -- insert into management.ERROR_EVENT_FACT table&#xA;insert into management.ERROR_EVENT_FACT&#xA;SELECT &#xA;(SELECT batch_key FROM management.BATCH_DIM WHERE BATCH_TYPE='batch') &#xA;,(SELECT DATE_KEY FROM management.DATE_DIM WHERE CONVERT(DATE,FULL_DATE)=CONVERT(DATE,GETDATE()) )&#xA;,convert(varchar, getdate(),21)&#xA;, 'HIGH'&#xA;,4&#xA;FROM  management.TABLE_DIM T2&#xA;WHERE T2.[SCHEMA]+'.'+T2.TABLE_NAME='conform.employee_termination_fact'&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ParameterBinding
                        SQLTask:ParameterName="0"
                        SQLTask:DtsVariableName="System::ErrorDescription"
                        SQLTask:ParameterDirection="Input"
                        SQLTask:DataType="130"
                        SQLTask:ParameterSize="-1" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Sequence Container - Fact Tables.PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{07D11B70-D506-47B9-BB1A-302393AE2DCF}"
          DTS:From="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{4C7BF364-E443-4B98-BC53-E76B1EED6C7A}"
      DTS:EventID="1701257339"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{2D797829-03FA-4575-A3EE-46AABB4CBEAF}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables />
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="222,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\EST - Write Job Finish info"
          TopLeft="35.15,273" />
        <NodeLayout
          Size="222,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\EST - Write Job Start info"
          TopLeft="35.15,28" />
        <NodeLayout
          Size="222,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\Get new records and update columns"
          TopLeft="35.15,191" />
        <NodeLayout
          Size="212,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT\Truncate table"
          TopLeft="39.15,101" />
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT.PrecedenceConstraints[Constraint]"
          TopLeft="145.65,70">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,31"
              Start="0,0"
              End="0,23.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT.PrecedenceConstraints[Constraint 1]"
          TopLeft="145.65,143">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,48"
              Start="0,0"
              End="0,40.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,40.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT.PrecedenceConstraints[Constraint 2]"
          TopLeft="146.15,233">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,40"
              Start="0,0"
              End="0,32.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,32.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="345,370"
          Size="345,413"
          Id="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT"
          TopLeft="5.5,5.49999999999989" />
        <NodeLayout
          Size="222,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\EST - Write Job Finish info"
          TopLeft="35.15,273" />
        <NodeLayout
          Size="222,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\EST - Write Job Start info"
          TopLeft="35.15,28" />
        <NodeLayout
          Size="222,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\Get new records and update columns"
          TopLeft="35.15,191" />
        <NodeLayout
          Size="212,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT\Truncate table"
          TopLeft="39.15,101" />
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT.PrecedenceConstraints[Constraint]"
          TopLeft="145.65,70">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,31"
              Start="0,0"
              End="0,23.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT.PrecedenceConstraints[Constraint 1]"
          TopLeft="145.65,143">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,48"
              Start="0,0"
              End="0,40.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,40.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT.PrecedenceConstraints[Constraint 2]"
          TopLeft="146.15,233">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,40"
              Start="0,0"
              End="0,32.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,32.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="345,370"
          Size="345,413"
          Id="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT"
          TopLeft="411.5,5.49999999999989" />
        <EdgeLayout
          Id="Package\Sequence Container - Fact Tables.PrecedenceConstraints[Constraint]"
          TopLeft="350.5,212">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="61,0"
              Start="0,0"
              End="53.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="53.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="762,473"
          Size="762,516"
          Id="Package\Sequence Container - Fact Tables"
          TopLeft="31.833333333333,1.99999999999818" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="264,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - DEBTOR_FACT.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
          TopLeft="448,222" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="264,42"
          Id="Package\Sequence Container - Fact Tables\SD1 - KPI_FACT.EventHandlers[OnError]\Execute SQL Task - Catch Error Details"
          TopLeft="448,222" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>